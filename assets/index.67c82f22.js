import{j as o,s as M}from"./ui-vendor.13fb4b83.js";import{n as oe,C as ge}from"./utils-vendor.8f0851ce.js";import{g as Ca,d as Ia,a as Ra,b as p,R as Wr,u as Xt,L as ft,e as Oa,N as Re,H as Ua,f as Ta,h as ve}from"./react-vendor.c637cbaf.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();const Pa="modulepreload",za=function(e){return"/Enterprise-Authentication-System/"+e},mn={},qe=function(r,t,n){if(!t||t.length===0)return r();const s=document.getElementsByTagName("link");return Promise.all(t.map(a=>{if(a=za(a),a in mn)return;mn[a]=!0;const l=a.endsWith(".css"),i=l?'[rel="stylesheet"]':"";if(!!n)for(let d=s.length-1;d>=0;d--){const x=s[d];if(x.href===a&&(!l||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${i}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":Pa,l||(c.as="script",c.crossOrigin=""),c.href=a,document.head.appendChild(c),l)return new Promise((d,x)=>{c.addEventListener("load",d),c.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>r()).catch(a=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a})},Ma=Ca(Ia);var ms,pn=Ma;ms=pn.createRoot,pn.hydrateRoot;var $a="Expected a function",_n=0/0,Fa="[object Symbol]",Ha=/^\s+|\s+$/g,Za=/^[-+]0x[0-9a-f]+$/i,Ba=/^0b[01]+$/i,Wa=/^0o[0-7]+$/i,Ga=parseInt,qa=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Ka=typeof self=="object"&&self&&self.Object===Object&&self,Ya=qa||Ka||Function("return this")(),Va=Object.prototype,Xa=Va.toString,Ja=Math.max,Qa=Math.min,fr=function(){return Ya.Date.now()};function eo(e,r,t){var n,s,a,l,i,f,c=0,d=!1,x=!1,g=!0;if(typeof e!="function")throw new TypeError($a);r=xn(r)||0,Ir(t)&&(d=!!t.leading,x="maxWait"in t,a=x?Ja(xn(t.maxWait)||0,r):a,g="trailing"in t?!!t.trailing:g);function h(N){var b=n,R=s;return n=s=void 0,c=N,l=e.apply(R,b),l}function w(N){return c=N,i=setTimeout(S,r),d?h(N):l}function O(N){var b=N-f,R=N-c,C=r-b;return x?Qa(C,a-R):C}function D(N){var b=N-f,R=N-c;return f===void 0||b>=r||b<0||x&&R>=a}function S(){var N=fr();if(D(N))return I(N);i=setTimeout(S,O(N))}function I(N){return i=void 0,g&&n?h(N):(n=s=void 0,l)}function E(){i!==void 0&&clearTimeout(i),c=0,n=f=s=i=void 0}function _(){return i===void 0?l:I(fr())}function L(){var N=fr(),b=D(N);if(n=arguments,s=this,f=N,b){if(i===void 0)return w(f);if(x)return i=setTimeout(S,r),h(f)}return i===void 0&&(i=setTimeout(S,r)),l}return L.cancel=E,L.flush=_,L}function Ir(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function to(e){return!!e&&typeof e=="object"}function ro(e){return typeof e=="symbol"||to(e)&&Xa.call(e)==Fa}function xn(e){if(typeof e=="number")return e;if(ro(e))return _n;if(Ir(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=Ir(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(Ha,"");var t=Ba.test(e);return t||Wa.test(e)?Ga(e.slice(2),t?2:8):Za.test(e)?_n:+e}var no=eo;const bn=Ra(no);var It,so=new Uint8Array(16);function ao(){if(!It&&(It=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!It))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return It(so)}const oo=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function io(e){return typeof e=="string"&&oo.test(e)}var Q=[];for(var ur=0;ur<256;++ur)Q.push((ur+256).toString(16).substr(1));function lo(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(Q[e[r+0]]+Q[e[r+1]]+Q[e[r+2]]+Q[e[r+3]]+"-"+Q[e[r+4]]+Q[e[r+5]]+"-"+Q[e[r+6]]+Q[e[r+7]]+"-"+Q[e[r+8]]+Q[e[r+9]]+"-"+Q[e[r+10]]+Q[e[r+11]]+Q[e[r+12]]+Q[e[r+13]]+Q[e[r+14]]+Q[e[r+15]]).toLowerCase();if(!io(t))throw TypeError("Stringified UUID is invalid");return t}function co(e,r,t){e=e||{};var n=e.random||(e.rng||ao)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,r){t=t||0;for(var s=0;s<16;++s)r[t+s]=n[s];return r}return lo(n)}const ps="enterprise_auth_devices",Ye="enterprise_auth_current_device",fo=10,De=()=>{try{const e=localStorage.getItem(ps);if(!e)return new Map;const r=JSON.parse(e),t=new Map;for(const n of r)t.set(n.id,n);return t}catch(e){return console.error("Error loading devices:",e),new Map}},Qe=e=>{try{const r=Array.from(e.values());r.sort((n,s)=>s.lastSeen-n.lastSeen);const t=r.slice(0,fo);localStorage.setItem(ps,JSON.stringify(t))}catch(r){console.error("Error saving devices:",r)}},uo=()=>{const e=navigator.userAgent;let r="Unknown";e.indexOf("Chrome")>-1?r="Chrome":e.indexOf("Safari")>-1?r="Safari":e.indexOf("Firefox")>-1?r="Firefox":e.indexOf("MSIE")>-1||e.indexOf("Trident/")>-1?r="Internet Explorer":e.indexOf("Edge")>-1&&(r="Edge");let t="Unknown";e.indexOf("Windows")>-1?t="Windows":e.indexOf("Mac")>-1?t="macOS":e.indexOf("Linux")>-1?t="Linux":e.indexOf("Android")>-1?t="Android":(e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1)&&(t="iOS");let n="Desktop";return e.indexOf("Mobi")>-1?n="Mobile":(e.indexOf("Tablet")>-1||e.indexOf("iPad")>-1)&&(n="Tablet"),{browser:r,os:t,deviceType:n}},ho=()=>{let e=localStorage.getItem("device_id");return e||(e=oe(),localStorage.setItem("device_id",e)),e},wn=()=>{const{browser:e,os:r,deviceType:t}=uo(),n=Date.now(),s=ho(),a={id:s,browser:e,os:r,deviceType:t,trusted:!1,lastSeen:n,firstSeen:n,location:"Unknown Location"};localStorage.setItem(Ye,JSON.stringify(a));const l=De();if(l.has(s)){const i=l.get(s);i.lastSeen=n,i.browser=e,i.os=r,i.deviceType=t,l.set(s,i)}else l.set(s,a);return Qe(l),a},Fe=()=>{try{const e=localStorage.getItem(Ye);if(e){const r=JSON.parse(e);return r.lastSeen=Date.now(),localStorage.setItem(Ye,JSON.stringify(r)),r}return wn()}catch(e){return console.error("Error getting current device:",e),wn()}},_s=e=>{const t={...Fe(),...e,lastSeen:Date.now()};localStorage.setItem(Ye,JSON.stringify(t));const n=De();return n.set(t.id,t),Qe(n),t},go=e=>_s({location:e}),xs=e=>De().get(e),mo=()=>{const e=De();return Array.from(e.values())},po=(e,r)=>{const t=De(),n=t.get(e);if(n)return n.trusted=r,n.lastSeen=Date.now(),t.set(e,n),Qe(t),e===Fe().id&&localStorage.setItem(Ye,JSON.stringify(n)),n},_o=e=>{const r=xs(e);return r?r.trusted:!1},xo=e=>{if(e===Fe().id)return!1;const r=De(),t=r.delete(e);return t&&Qe(r),t},bo=()=>{const e=Fe().id,r=De();let t=0;for(const n of r.keys())n!==e&&(r.delete(n),t++);return Qe(r),t},wo=(e,r)=>{const t=De(),n=t.get(e);if(n)return n.name=r,n.lastSeen=Date.now(),t.set(e,n),Qe(t),e===Fe().id&&localStorage.setItem(Ye,JSON.stringify(n)),n},yo=()=>{Fe()};yo();const vo={getCurrentDevice:Fe,updateCurrentDevice:_s,updateCurrentDeviceLocation:go,getDevice:xs,getAllDevices:mo,setDeviceTrusted:po,isDeviceTrusted:_o,removeDevice:xo,removeAllOtherDevices:bo,renameDevice:wo};var Y=(e=>(e.LOGIN_ATTEMPT="login_attempt",e.LOGIN_SUCCESS="login_success",e.LOGIN_ERROR="login_error",e.LOGOUT="logout",e.SIGNUP_ATTEMPT="signup_attempt",e.SIGNUP_SUCCESS="signup_success",e.SIGNUP_ERROR="signup_error",e.PASSWORD_RESET="password_reset",e.PASSWORD_RESET_REQUEST="password_reset_request",e.PASSWORD_RESET_COMPLETE="password_reset_complete",e.MFA_REQUIRED="mfa_required",e.MFA_SUCCESS="mfa_success",e.MFA_ERROR="mfa_error",e.ADMIN_LOGIN="admin_login",e.PASSWORDLESS_REQUEST="passwordless_request",e.PASSWORDLESS_SUCCESS="passwordless_success",e.PASSWORDLESS_ERROR="passwordless_error",e.SSO_ATTEMPT="sso_attempt",e.SSO_SUCCESS="sso_success",e.SSO_ERROR="sso_error",e.SUSPICIOUS_ACTIVITY="suspicious_activity",e.ACCOUNT_LOCKED="account_locked",e.ACCOUNT_UNLOCKED="account_unlocked",e.SESSION_EXTENDED="session_extended",e.SESSION_EXPIRED="session_expired",e.DEVICE_ADDED="device_added",e.DEVICE_REMOVED="device_removed",e.DEVICE_TRUSTED="device_trusted",e.DEVICE_UNTRUSTED="device_untrusted",e.MFA_FAILURE="mfa_failure",e.LOGIN_FAILURE="login_failure",e.SSO_INITIATED="sso_initiated",e.SSO_FAILURE="sso_failure",e.PASSWORDLESS_INITIATED="passwordless_initiated",e.PASSWORDLESS_FAILURE="passwordless_failure",e.PASSWORD_CHANGE="password_change",e.MFA_ENABLED="mfa_enabled",e.MFA_DISABLED="mfa_disabled",e.REGISTRATION="registration",e))(Y||{});const yn={},V=(e,r={})=>{const t=Date.now(),n=navigator.userAgent,s=vo.getCurrentDevice();r.timestamp||(r.timestamp=new Date().toISOString());const a=`${e}-${r.userId||r.email||"anonymous"}`,l=yn[a];if(l&&t-l.time<1e3)return{type:e,timestamp:l.time,userId:r.userId,deviceId:s?.id,ip:r.ip,location:r.location,metadata:r.metadata,userAgent:n};const i={type:e,timestamp:t,userId:r.userId,deviceId:s?.id,ip:r.ip,userAgent:n,location:r.location,metadata:r.metadata};console.log(`[Auth Event] ${e}`,{...r,device:s?.browser,timestamp:new Date(t).toISOString()}),yn[a]={time:t,id:crypto.randomUUID()};const f=Eo();return f.push(i),ko(f),e.toString().includes("error")&&r.error&&console.warn(`[Auth Error] ${e}: ${r.error}`,{email:r.email,timestamp:r.timestamp}),(e==="login_error"||e==="login_failure")&&r.metadata?.attempts>3&&(console.warn(`[Security Alert] Multiple failed login attempts for: ${r.email}`),So(r.email||"unknown","multiple_failed_logins")),i};function So(e,r,t){console.warn(`[Security Alert] Suspicious activity detected for user ${e}: ${r}`),V("suspicious_activity",{userId:e,timestamp:new Date().toISOString(),metadata:{activityType:r,...t}}),(r==="multiple_failed_logins"||r==="unusual_location")&&console.log(`Account security measures initiated for ${e}`)}const bs="auth_analytics_events",Eo=()=>{try{const e=localStorage.getItem(bs);if(e)return JSON.parse(e)}catch(e){console.error("Error retrieving analytics data:",e)}return[]},ko=e=>{try{const r=e.slice(-1e3);localStorage.setItem(bs,JSON.stringify(r))}catch(r){console.error("Error saving analytics data:",r)}},Rt=(e,r=500)=>new Promise(t=>{setTimeout(()=>{t(e)},r)});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Ao=4,vn=0,Sn=1,jo=2;function et(e){let r=e.length;for(;--r>=0;)e[r]=0}const Do=0,ws=1,Lo=2,No=3,Co=258,Gr=29,At=256,mt=At+1+Gr,Ke=30,qr=19,ys=2*mt+1,Oe=15,hr=16,Io=7,Kr=256,vs=16,Ss=17,Es=18,Rr=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Zt=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ro=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ks=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Oo=512,be=new Array((mt+2)*2);et(be);const ut=new Array(Ke*2);et(ut);const pt=new Array(Oo);et(pt);const _t=new Array(Co-No+1);et(_t);const Yr=new Array(Gr);et(Yr);const Kt=new Array(Ke);et(Kt);function gr(e,r,t,n,s){this.static_tree=e,this.extra_bits=r,this.extra_base=t,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}let As,js,Ds;function mr(e,r){this.dyn_tree=e,this.max_code=0,this.stat_desc=r}const Ls=e=>e<256?pt[e]:pt[256+(e>>>7)],xt=(e,r)=>{e.pending_buf[e.pending++]=r&255,e.pending_buf[e.pending++]=r>>>8&255},ne=(e,r,t)=>{e.bi_valid>hr-t?(e.bi_buf|=r<<e.bi_valid&65535,xt(e,e.bi_buf),e.bi_buf=r>>hr-e.bi_valid,e.bi_valid+=t-hr):(e.bi_buf|=r<<e.bi_valid&65535,e.bi_valid+=t)},he=(e,r,t)=>{ne(e,t[r*2],t[r*2+1])},Ns=(e,r)=>{let t=0;do t|=e&1,e>>>=1,t<<=1;while(--r>0);return t>>>1},Uo=e=>{e.bi_valid===16?(xt(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},To=(e,r)=>{const t=r.dyn_tree,n=r.max_code,s=r.stat_desc.static_tree,a=r.stat_desc.has_stree,l=r.stat_desc.extra_bits,i=r.stat_desc.extra_base,f=r.stat_desc.max_length;let c,d,x,g,h,w,O=0;for(g=0;g<=Oe;g++)e.bl_count[g]=0;for(t[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<ys;c++)d=e.heap[c],g=t[t[d*2+1]*2+1]+1,g>f&&(g=f,O++),t[d*2+1]=g,!(d>n)&&(e.bl_count[g]++,h=0,d>=i&&(h=l[d-i]),w=t[d*2],e.opt_len+=w*(g+h),a&&(e.static_len+=w*(s[d*2+1]+h)));if(O!==0){do{for(g=f-1;e.bl_count[g]===0;)g--;e.bl_count[g]--,e.bl_count[g+1]+=2,e.bl_count[f]--,O-=2}while(O>0);for(g=f;g!==0;g--)for(d=e.bl_count[g];d!==0;)x=e.heap[--c],!(x>n)&&(t[x*2+1]!==g&&(e.opt_len+=(g-t[x*2+1])*t[x*2],t[x*2+1]=g),d--)}},Cs=(e,r,t)=>{const n=new Array(Oe+1);let s=0,a,l;for(a=1;a<=Oe;a++)s=s+t[a-1]<<1,n[a]=s;for(l=0;l<=r;l++){let i=e[l*2+1];i!==0&&(e[l*2]=Ns(n[i]++,i))}},Po=()=>{let e,r,t,n,s;const a=new Array(Oe+1);for(t=0,n=0;n<Gr-1;n++)for(Yr[n]=t,e=0;e<1<<Rr[n];e++)_t[t++]=n;for(_t[t-1]=n,s=0,n=0;n<16;n++)for(Kt[n]=s,e=0;e<1<<Zt[n];e++)pt[s++]=n;for(s>>=7;n<Ke;n++)for(Kt[n]=s<<7,e=0;e<1<<Zt[n]-7;e++)pt[256+s++]=n;for(r=0;r<=Oe;r++)a[r]=0;for(e=0;e<=143;)be[e*2+1]=8,e++,a[8]++;for(;e<=255;)be[e*2+1]=9,e++,a[9]++;for(;e<=279;)be[e*2+1]=7,e++,a[7]++;for(;e<=287;)be[e*2+1]=8,e++,a[8]++;for(Cs(be,mt+1,a),e=0;e<Ke;e++)ut[e*2+1]=5,ut[e*2]=Ns(e,5);As=new gr(be,Rr,At+1,mt,Oe),js=new gr(ut,Zt,0,Ke,Oe),Ds=new gr(new Array(0),Ro,0,qr,Io)},Is=e=>{let r;for(r=0;r<mt;r++)e.dyn_ltree[r*2]=0;for(r=0;r<Ke;r++)e.dyn_dtree[r*2]=0;for(r=0;r<qr;r++)e.bl_tree[r*2]=0;e.dyn_ltree[Kr*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Rs=e=>{e.bi_valid>8?xt(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},En=(e,r,t,n)=>{const s=r*2,a=t*2;return e[s]<e[a]||e[s]===e[a]&&n[r]<=n[t]},pr=(e,r,t)=>{const n=e.heap[t];let s=t<<1;for(;s<=e.heap_len&&(s<e.heap_len&&En(r,e.heap[s+1],e.heap[s],e.depth)&&s++,!En(r,n,e.heap[s],e.depth));)e.heap[t]=e.heap[s],t=s,s<<=1;e.heap[t]=n},kn=(e,r,t)=>{let n,s,a=0,l,i;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+a++]&255,n+=(e.pending_buf[e.sym_buf+a++]&255)<<8,s=e.pending_buf[e.sym_buf+a++],n===0?he(e,s,r):(l=_t[s],he(e,l+At+1,r),i=Rr[l],i!==0&&(s-=Yr[l],ne(e,s,i)),n--,l=Ls(n),he(e,l,t),i=Zt[l],i!==0&&(n-=Kt[l],ne(e,n,i)));while(a<e.sym_next);he(e,Kr,r)},Or=(e,r)=>{const t=r.dyn_tree,n=r.stat_desc.static_tree,s=r.stat_desc.has_stree,a=r.stat_desc.elems;let l,i,f=-1,c;for(e.heap_len=0,e.heap_max=ys,l=0;l<a;l++)t[l*2]!==0?(e.heap[++e.heap_len]=f=l,e.depth[l]=0):t[l*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=f<2?++f:0,t[c*2]=1,e.depth[c]=0,e.opt_len--,s&&(e.static_len-=n[c*2+1]);for(r.max_code=f,l=e.heap_len>>1;l>=1;l--)pr(e,t,l);c=a;do l=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pr(e,t,1),i=e.heap[1],e.heap[--e.heap_max]=l,e.heap[--e.heap_max]=i,t[c*2]=t[l*2]+t[i*2],e.depth[c]=(e.depth[l]>=e.depth[i]?e.depth[l]:e.depth[i])+1,t[l*2+1]=t[i*2+1]=c,e.heap[1]=c++,pr(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],To(e,r),Cs(t,f,e.bl_count)},An=(e,r,t)=>{let n,s=-1,a,l=r[0*2+1],i=0,f=7,c=4;for(l===0&&(f=138,c=3),r[(t+1)*2+1]=65535,n=0;n<=t;n++)a=l,l=r[(n+1)*2+1],!(++i<f&&a===l)&&(i<c?e.bl_tree[a*2]+=i:a!==0?(a!==s&&e.bl_tree[a*2]++,e.bl_tree[vs*2]++):i<=10?e.bl_tree[Ss*2]++:e.bl_tree[Es*2]++,i=0,s=a,l===0?(f=138,c=3):a===l?(f=6,c=3):(f=7,c=4))},jn=(e,r,t)=>{let n,s=-1,a,l=r[0*2+1],i=0,f=7,c=4;for(l===0&&(f=138,c=3),n=0;n<=t;n++)if(a=l,l=r[(n+1)*2+1],!(++i<f&&a===l)){if(i<c)do he(e,a,e.bl_tree);while(--i!==0);else a!==0?(a!==s&&(he(e,a,e.bl_tree),i--),he(e,vs,e.bl_tree),ne(e,i-3,2)):i<=10?(he(e,Ss,e.bl_tree),ne(e,i-3,3)):(he(e,Es,e.bl_tree),ne(e,i-11,7));i=0,s=a,l===0?(f=138,c=3):a===l?(f=6,c=3):(f=7,c=4)}},zo=e=>{let r;for(An(e,e.dyn_ltree,e.l_desc.max_code),An(e,e.dyn_dtree,e.d_desc.max_code),Or(e,e.bl_desc),r=qr-1;r>=3&&e.bl_tree[ks[r]*2+1]===0;r--);return e.opt_len+=3*(r+1)+5+5+4,r},Mo=(e,r,t,n)=>{let s;for(ne(e,r-257,5),ne(e,t-1,5),ne(e,n-4,4),s=0;s<n;s++)ne(e,e.bl_tree[ks[s]*2+1],3);jn(e,e.dyn_ltree,r-1),jn(e,e.dyn_dtree,t-1)},$o=e=>{let r=4093624447,t;for(t=0;t<=31;t++,r>>>=1)if(r&1&&e.dyn_ltree[t*2]!==0)return vn;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Sn;for(t=32;t<At;t++)if(e.dyn_ltree[t*2]!==0)return Sn;return vn};let Dn=!1;const Fo=e=>{Dn||(Po(),Dn=!0),e.l_desc=new mr(e.dyn_ltree,As),e.d_desc=new mr(e.dyn_dtree,js),e.bl_desc=new mr(e.bl_tree,Ds),e.bi_buf=0,e.bi_valid=0,Is(e)},Os=(e,r,t,n)=>{ne(e,(Do<<1)+(n?1:0),3),Rs(e),xt(e,t),xt(e,~t),t&&e.pending_buf.set(e.window.subarray(r,r+t),e.pending),e.pending+=t},Ho=e=>{ne(e,ws<<1,3),he(e,Kr,be),Uo(e)},Zo=(e,r,t,n)=>{let s,a,l=0;e.level>0?(e.strm.data_type===jo&&(e.strm.data_type=$o(e)),Or(e,e.l_desc),Or(e,e.d_desc),l=zo(e),s=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=s&&(s=a)):s=a=t+5,t+4<=s&&r!==-1?Os(e,r,t,n):e.strategy===Ao||a===s?(ne(e,(ws<<1)+(n?1:0),3),kn(e,be,ut)):(ne(e,(Lo<<1)+(n?1:0),3),Mo(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),kn(e,e.dyn_ltree,e.dyn_dtree)),Is(e),n&&Rs(e)},Bo=(e,r,t)=>(e.pending_buf[e.sym_buf+e.sym_next++]=r,e.pending_buf[e.sym_buf+e.sym_next++]=r>>8,e.pending_buf[e.sym_buf+e.sym_next++]=t,r===0?e.dyn_ltree[t*2]++:(e.matches++,r--,e.dyn_ltree[(_t[t]+At+1)*2]++,e.dyn_dtree[Ls(r)*2]++),e.sym_next===e.sym_end);var Wo=Fo,Go=Os,qo=Zo,Ko=Bo,Yo=Ho,Vo={_tr_init:Wo,_tr_stored_block:Go,_tr_flush_block:qo,_tr_tally:Ko,_tr_align:Yo};const Xo=(e,r,t,n)=>{let s=e&65535|0,a=e>>>16&65535|0,l=0;for(;t!==0;){l=t>2e3?2e3:t,t-=l;do s=s+r[n++]|0,a=a+s|0;while(--l);s%=65521,a%=65521}return s|a<<16|0};var bt=Xo;const Jo=()=>{let e,r=[];for(var t=0;t<256;t++){e=t;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r},Qo=new Uint32Array(Jo()),ei=(e,r,t,n)=>{const s=Qo,a=n+t;e^=-1;for(let l=n;l<a;l++)e=e>>>8^s[(e^r[l])&255];return e^-1};var X=ei,Pe={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},tt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ti,_tr_stored_block:Ur,_tr_flush_block:ri,_tr_tally:ke,_tr_align:ni}=Vo,{Z_NO_FLUSH:Ae,Z_PARTIAL_FLUSH:si,Z_FULL_FLUSH:ai,Z_FINISH:le,Z_BLOCK:Ln,Z_OK:ee,Z_STREAM_END:Nn,Z_STREAM_ERROR:me,Z_DATA_ERROR:oi,Z_BUF_ERROR:_r,Z_DEFAULT_COMPRESSION:ii,Z_FILTERED:li,Z_HUFFMAN_ONLY:Ot,Z_RLE:ci,Z_FIXED:di,Z_DEFAULT_STRATEGY:fi,Z_UNKNOWN:ui,Z_DEFLATED:Jt}=tt,hi=9,gi=15,mi=8,pi=29,_i=256,Tr=_i+1+pi,xi=30,bi=19,wi=2*Tr+1,yi=15,T=3,Ee=258,pe=Ee+T+1,vi=32,Ve=42,Vr=57,Pr=69,zr=73,Mr=91,$r=103,Ue=113,it=666,re=1,rt=2,ze=3,nt=4,Si=3,Te=(e,r)=>(e.msg=Pe[r],r),Cn=e=>e*2-(e>4?9:0),Se=e=>{let r=e.length;for(;--r>=0;)e[r]=0},Ei=e=>{let r,t,n,s=e.w_size;r=e.hash_size,n=r;do t=e.head[--n],e.head[n]=t>=s?t-s:0;while(--r);r=s,n=r;do t=e.prev[--n],e.prev[n]=t>=s?t-s:0;while(--r)};let ki=(e,r,t)=>(r<<e.hash_shift^t)&e.hash_mask,je=ki;const se=e=>{const r=e.state;let t=r.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(e.output.set(r.pending_buf.subarray(r.pending_out,r.pending_out+t),e.next_out),e.next_out+=t,r.pending_out+=t,e.total_out+=t,e.avail_out-=t,r.pending-=t,r.pending===0&&(r.pending_out=0))},ae=(e,r)=>{ri(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r),e.block_start=e.strstart,se(e.strm)},z=(e,r)=>{e.pending_buf[e.pending++]=r},ot=(e,r)=>{e.pending_buf[e.pending++]=r>>>8&255,e.pending_buf[e.pending++]=r&255},Fr=(e,r,t,n)=>{let s=e.avail_in;return s>n&&(s=n),s===0?0:(e.avail_in-=s,r.set(e.input.subarray(e.next_in,e.next_in+s),t),e.state.wrap===1?e.adler=bt(e.adler,r,s,t):e.state.wrap===2&&(e.adler=X(e.adler,r,s,t)),e.next_in+=s,e.total_in+=s,s)},Us=(e,r)=>{let t=e.max_chain_length,n=e.strstart,s,a,l=e.prev_length,i=e.nice_match;const f=e.strstart>e.w_size-pe?e.strstart-(e.w_size-pe):0,c=e.window,d=e.w_mask,x=e.prev,g=e.strstart+Ee;let h=c[n+l-1],w=c[n+l];e.prev_length>=e.good_match&&(t>>=2),i>e.lookahead&&(i=e.lookahead);do if(s=r,!(c[s+l]!==w||c[s+l-1]!==h||c[s]!==c[n]||c[++s]!==c[n+1])){n+=2,s++;do;while(c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&n<g);if(a=Ee-(g-n),n=g-Ee,a>l){if(e.match_start=r,l=a,a>=i)break;h=c[n+l-1],w=c[n+l]}}while((r=x[r&d])>f&&--t!==0);return l<=e.lookahead?l:e.lookahead},Xe=e=>{const r=e.w_size;let t,n,s;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-pe)&&(e.window.set(e.window.subarray(r,r+r-n),0),e.match_start-=r,e.strstart-=r,e.block_start-=r,e.insert>e.strstart&&(e.insert=e.strstart),Ei(e),n+=r),e.strm.avail_in===0)break;if(t=Fr(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=t,e.lookahead+e.insert>=T)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=je(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=je(e,e.ins_h,e.window[s+T-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<T)););}while(e.lookahead<pe&&e.strm.avail_in!==0)},Ts=(e,r)=>{let t=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,s,a,l=0,i=e.strm.avail_in;do{if(n=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,s=e.strstart-e.block_start,n>s+e.strm.avail_in&&(n=s+e.strm.avail_in),n>a&&(n=a),n<t&&(n===0&&r!==le||r===Ae||n!==s+e.strm.avail_in)))break;l=r===le&&n===s+e.strm.avail_in?1:0,Ur(e,0,0,l),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,se(e.strm),s&&(s>n&&(s=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,n-=s),n&&(Fr(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(l===0);return i-=e.strm.avail_in,i&&(i>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=i&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-i,e.strm.next_in),e.strstart),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),l?nt:r!==Ae&&r!==le&&e.strm.avail_in===0&&e.strstart===e.block_start?rt:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(Fr(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,t=a>e.w_size?e.w_size:a,s=e.strstart-e.block_start,(s>=t||(s||r===le)&&r!==Ae&&e.strm.avail_in===0&&s<=a)&&(n=s>a?a:s,l=r===le&&e.strm.avail_in===0&&n===s?1:0,Ur(e,e.block_start,n,l),e.block_start+=n,se(e.strm)),l?ze:re)},xr=(e,r)=>{let t,n;for(;;){if(e.lookahead<pe){if(Xe(e),e.lookahead<pe&&r===Ae)return re;if(e.lookahead===0)break}if(t=0,e.lookahead>=T&&(e.ins_h=je(e,e.ins_h,e.window[e.strstart+T-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-pe&&(e.match_length=Us(e,t)),e.match_length>=T)if(n=ke(e,e.strstart-e.match_start,e.match_length-T),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=T){e.match_length--;do e.strstart++,e.ins_h=je(e,e.ins_h,e.window[e.strstart+T-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=je(e,e.ins_h,e.window[e.strstart+1]);else n=ke(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(ae(e,!1),e.strm.avail_out===0))return re}return e.insert=e.strstart<T-1?e.strstart:T-1,r===le?(ae(e,!0),e.strm.avail_out===0?ze:nt):e.sym_next&&(ae(e,!1),e.strm.avail_out===0)?re:rt},Be=(e,r)=>{let t,n,s;for(;;){if(e.lookahead<pe){if(Xe(e),e.lookahead<pe&&r===Ae)return re;if(e.lookahead===0)break}if(t=0,e.lookahead>=T&&(e.ins_h=je(e,e.ins_h,e.window[e.strstart+T-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=T-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-pe&&(e.match_length=Us(e,t),e.match_length<=5&&(e.strategy===li||e.match_length===T&&e.strstart-e.match_start>4096)&&(e.match_length=T-1)),e.prev_length>=T&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-T,n=ke(e,e.strstart-1-e.prev_match,e.prev_length-T),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=je(e,e.ins_h,e.window[e.strstart+T-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=T-1,e.strstart++,n&&(ae(e,!1),e.strm.avail_out===0))return re}else if(e.match_available){if(n=ke(e,0,e.window[e.strstart-1]),n&&ae(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return re}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=ke(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<T-1?e.strstart:T-1,r===le?(ae(e,!0),e.strm.avail_out===0?ze:nt):e.sym_next&&(ae(e,!1),e.strm.avail_out===0)?re:rt},Ai=(e,r)=>{let t,n,s,a;const l=e.window;for(;;){if(e.lookahead<=Ee){if(Xe(e),e.lookahead<=Ee&&r===Ae)return re;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=T&&e.strstart>0&&(s=e.strstart-1,n=l[s],n===l[++s]&&n===l[++s]&&n===l[++s])){a=e.strstart+Ee;do;while(n===l[++s]&&n===l[++s]&&n===l[++s]&&n===l[++s]&&n===l[++s]&&n===l[++s]&&n===l[++s]&&n===l[++s]&&s<a);e.match_length=Ee-(a-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=T?(t=ke(e,1,e.match_length-T),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=ke(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(ae(e,!1),e.strm.avail_out===0))return re}return e.insert=0,r===le?(ae(e,!0),e.strm.avail_out===0?ze:nt):e.sym_next&&(ae(e,!1),e.strm.avail_out===0)?re:rt},ji=(e,r)=>{let t;for(;;){if(e.lookahead===0&&(Xe(e),e.lookahead===0)){if(r===Ae)return re;break}if(e.match_length=0,t=ke(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(ae(e,!1),e.strm.avail_out===0))return re}return e.insert=0,r===le?(ae(e,!0),e.strm.avail_out===0?ze:nt):e.sym_next&&(ae(e,!1),e.strm.avail_out===0)?re:rt};function ue(e,r,t,n,s){this.good_length=e,this.max_lazy=r,this.nice_length=t,this.max_chain=n,this.func=s}const lt=[new ue(0,0,0,0,Ts),new ue(4,4,8,4,xr),new ue(4,5,16,8,xr),new ue(4,6,32,32,xr),new ue(4,4,16,16,Be),new ue(8,16,32,32,Be),new ue(8,16,128,128,Be),new ue(8,32,128,256,Be),new ue(32,128,258,1024,Be),new ue(32,258,258,4096,Be)],Di=e=>{e.window_size=2*e.w_size,Se(e.head),e.max_lazy_match=lt[e.level].max_lazy,e.good_match=lt[e.level].good_length,e.nice_match=lt[e.level].nice_length,e.max_chain_length=lt[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=T-1,e.match_available=0,e.ins_h=0};function Li(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Jt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(wi*2),this.dyn_dtree=new Uint16Array((2*xi+1)*2),this.bl_tree=new Uint16Array((2*bi+1)*2),Se(this.dyn_ltree),Se(this.dyn_dtree),Se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(yi+1),this.heap=new Uint16Array(2*Tr+1),Se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Tr+1),Se(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const jt=e=>{if(!e)return 1;const r=e.state;return!r||r.strm!==e||r.status!==Ve&&r.status!==Vr&&r.status!==Pr&&r.status!==zr&&r.status!==Mr&&r.status!==$r&&r.status!==Ue&&r.status!==it?1:0},Ps=e=>{if(jt(e))return Te(e,me);e.total_in=e.total_out=0,e.data_type=ui;const r=e.state;return r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap===2?Vr:r.wrap?Ve:Ue,e.adler=r.wrap===2?0:1,r.last_flush=-2,ti(r),ee},zs=e=>{const r=Ps(e);return r===ee&&Di(e.state),r},Ni=(e,r)=>jt(e)||e.state.wrap!==2?me:(e.state.gzhead=r,ee),Ms=(e,r,t,n,s,a)=>{if(!e)return me;let l=1;if(r===ii&&(r=6),n<0?(l=0,n=-n):n>15&&(l=2,n-=16),s<1||s>hi||t!==Jt||n<8||n>15||r<0||r>9||a<0||a>di||n===8&&l!==1)return Te(e,me);n===8&&(n=9);const i=new Li;return e.state=i,i.strm=e,i.status=Ve,i.wrap=l,i.gzhead=null,i.w_bits=n,i.w_size=1<<i.w_bits,i.w_mask=i.w_size-1,i.hash_bits=s+7,i.hash_size=1<<i.hash_bits,i.hash_mask=i.hash_size-1,i.hash_shift=~~((i.hash_bits+T-1)/T),i.window=new Uint8Array(i.w_size*2),i.head=new Uint16Array(i.hash_size),i.prev=new Uint16Array(i.w_size),i.lit_bufsize=1<<s+6,i.pending_buf_size=i.lit_bufsize*4,i.pending_buf=new Uint8Array(i.pending_buf_size),i.sym_buf=i.lit_bufsize,i.sym_end=(i.lit_bufsize-1)*3,i.level=r,i.strategy=a,i.method=t,zs(e)},Ci=(e,r)=>Ms(e,r,Jt,gi,mi,fi),Ii=(e,r)=>{if(jt(e)||r>Ln||r<0)return e?Te(e,me):me;const t=e.state;if(!e.output||e.avail_in!==0&&!e.input||t.status===it&&r!==le)return Te(e,e.avail_out===0?_r:me);const n=t.last_flush;if(t.last_flush=r,t.pending!==0){if(se(e),e.avail_out===0)return t.last_flush=-1,ee}else if(e.avail_in===0&&Cn(r)<=Cn(n)&&r!==le)return Te(e,_r);if(t.status===it&&e.avail_in!==0)return Te(e,_r);if(t.status===Ve&&t.wrap===0&&(t.status=Ue),t.status===Ve){let s=Jt+(t.w_bits-8<<4)<<8,a=-1;if(t.strategy>=Ot||t.level<2?a=0:t.level<6?a=1:t.level===6?a=2:a=3,s|=a<<6,t.strstart!==0&&(s|=vi),s+=31-s%31,ot(t,s),t.strstart!==0&&(ot(t,e.adler>>>16),ot(t,e.adler&65535)),e.adler=1,t.status=Ue,se(e),t.pending!==0)return t.last_flush=-1,ee}if(t.status===Vr){if(e.adler=0,z(t,31),z(t,139),z(t,8),t.gzhead)z(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),z(t,t.gzhead.time&255),z(t,t.gzhead.time>>8&255),z(t,t.gzhead.time>>16&255),z(t,t.gzhead.time>>24&255),z(t,t.level===9?2:t.strategy>=Ot||t.level<2?4:0),z(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(z(t,t.gzhead.extra.length&255),z(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(e.adler=X(e.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=Pr;else if(z(t,0),z(t,0),z(t,0),z(t,0),z(t,0),z(t,t.level===9?2:t.strategy>=Ot||t.level<2?4:0),z(t,Si),t.status=Ue,se(e),t.pending!==0)return t.last_flush=-1,ee}if(t.status===Pr){if(t.gzhead.extra){let s=t.pending,a=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+a>t.pending_buf_size;){let i=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+i),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>s&&(e.adler=X(e.adler,t.pending_buf,t.pending-s,s)),t.gzindex+=i,se(e),t.pending!==0)return t.last_flush=-1,ee;s=0,a-=i}let l=new Uint8Array(t.gzhead.extra);t.pending_buf.set(l.subarray(t.gzindex,t.gzindex+a),t.pending),t.pending+=a,t.gzhead.hcrc&&t.pending>s&&(e.adler=X(e.adler,t.pending_buf,t.pending-s,s)),t.gzindex=0}t.status=zr}if(t.status===zr){if(t.gzhead.name){let s=t.pending,a;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>s&&(e.adler=X(e.adler,t.pending_buf,t.pending-s,s)),se(e),t.pending!==0)return t.last_flush=-1,ee;s=0}t.gzindex<t.gzhead.name.length?a=t.gzhead.name.charCodeAt(t.gzindex++)&255:a=0,z(t,a)}while(a!==0);t.gzhead.hcrc&&t.pending>s&&(e.adler=X(e.adler,t.pending_buf,t.pending-s,s)),t.gzindex=0}t.status=Mr}if(t.status===Mr){if(t.gzhead.comment){let s=t.pending,a;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>s&&(e.adler=X(e.adler,t.pending_buf,t.pending-s,s)),se(e),t.pending!==0)return t.last_flush=-1,ee;s=0}t.gzindex<t.gzhead.comment.length?a=t.gzhead.comment.charCodeAt(t.gzindex++)&255:a=0,z(t,a)}while(a!==0);t.gzhead.hcrc&&t.pending>s&&(e.adler=X(e.adler,t.pending_buf,t.pending-s,s))}t.status=$r}if(t.status===$r){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(se(e),t.pending!==0))return t.last_flush=-1,ee;z(t,e.adler&255),z(t,e.adler>>8&255),e.adler=0}if(t.status=Ue,se(e),t.pending!==0)return t.last_flush=-1,ee}if(e.avail_in!==0||t.lookahead!==0||r!==Ae&&t.status!==it){let s=t.level===0?Ts(t,r):t.strategy===Ot?ji(t,r):t.strategy===ci?Ai(t,r):lt[t.level].func(t,r);if((s===ze||s===nt)&&(t.status=it),s===re||s===ze)return e.avail_out===0&&(t.last_flush=-1),ee;if(s===rt&&(r===si?ni(t):r!==Ln&&(Ur(t,0,0,!1),r===ai&&(Se(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),se(e),e.avail_out===0))return t.last_flush=-1,ee}return r!==le?ee:t.wrap<=0?Nn:(t.wrap===2?(z(t,e.adler&255),z(t,e.adler>>8&255),z(t,e.adler>>16&255),z(t,e.adler>>24&255),z(t,e.total_in&255),z(t,e.total_in>>8&255),z(t,e.total_in>>16&255),z(t,e.total_in>>24&255)):(ot(t,e.adler>>>16),ot(t,e.adler&65535)),se(e),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?ee:Nn)},Ri=e=>{if(jt(e))return me;const r=e.state.status;return e.state=null,r===Ue?Te(e,oi):ee},Oi=(e,r)=>{let t=r.length;if(jt(e))return me;const n=e.state,s=n.wrap;if(s===2||s===1&&n.status!==Ve||n.lookahead)return me;if(s===1&&(e.adler=bt(e.adler,r,t,0)),n.wrap=0,t>=n.w_size){s===0&&(Se(n.head),n.strstart=0,n.block_start=0,n.insert=0);let f=new Uint8Array(n.w_size);f.set(r.subarray(t-n.w_size,t),0),r=f,t=n.w_size}const a=e.avail_in,l=e.next_in,i=e.input;for(e.avail_in=t,e.next_in=0,e.input=r,Xe(n);n.lookahead>=T;){let f=n.strstart,c=n.lookahead-(T-1);do n.ins_h=je(n,n.ins_h,n.window[f+T-1]),n.prev[f&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=f,f++;while(--c);n.strstart=f,n.lookahead=T-1,Xe(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=T-1,n.match_available=0,e.next_in=l,e.input=i,e.avail_in=a,n.wrap=s,ee};var Ui=Ci,Ti=Ms,Pi=zs,zi=Ps,Mi=Ni,$i=Ii,Fi=Ri,Hi=Oi,Zi="pako deflate (from Nodeca project)",ht={deflateInit:Ui,deflateInit2:Ti,deflateReset:Pi,deflateResetKeep:zi,deflateSetHeader:Mi,deflate:$i,deflateEnd:Fi,deflateSetDictionary:Hi,deflateInfo:Zi};const Bi=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);var Wi=function(e){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const t=r.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const n in t)Bi(t,n)&&(e[n]=t[n])}}return e},Gi=e=>{let r=0;for(let n=0,s=e.length;n<s;n++)r+=e[n].length;const t=new Uint8Array(r);for(let n=0,s=0,a=e.length;n<a;n++){let l=e[n];t.set(l,s),s+=l.length}return t},Qt={assign:Wi,flattenChunks:Gi};let $s=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{$s=!1}const wt=new Uint8Array(256);for(let e=0;e<256;e++)wt[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;wt[254]=wt[254]=1;var qi=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let r,t,n,s,a,l=e.length,i=0;for(s=0;s<l;s++)t=e.charCodeAt(s),(t&64512)===55296&&s+1<l&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),i+=t<128?1:t<2048?2:t<65536?3:4;for(r=new Uint8Array(i),a=0,s=0;a<i;s++)t=e.charCodeAt(s),(t&64512)===55296&&s+1<l&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(t=65536+(t-55296<<10)+(n-56320),s++)),t<128?r[a++]=t:t<2048?(r[a++]=192|t>>>6,r[a++]=128|t&63):t<65536?(r[a++]=224|t>>>12,r[a++]=128|t>>>6&63,r[a++]=128|t&63):(r[a++]=240|t>>>18,r[a++]=128|t>>>12&63,r[a++]=128|t>>>6&63,r[a++]=128|t&63);return r};const Ki=(e,r)=>{if(r<65534&&e.subarray&&$s)return String.fromCharCode.apply(null,e.length===r?e:e.subarray(0,r));let t="";for(let n=0;n<r;n++)t+=String.fromCharCode(e[n]);return t};var Yi=(e,r)=>{const t=r||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,r));let n,s;const a=new Array(t*2);for(s=0,n=0;n<t;){let l=e[n++];if(l<128){a[s++]=l;continue}let i=wt[l];if(i>4){a[s++]=65533,n+=i-1;continue}for(l&=i===2?31:i===3?15:7;i>1&&n<t;)l=l<<6|e[n++]&63,i--;if(i>1){a[s++]=65533;continue}l<65536?a[s++]=l:(l-=65536,a[s++]=55296|l>>10&1023,a[s++]=56320|l&1023)}return Ki(a,s)},Vi=(e,r)=>{r=r||e.length,r>e.length&&(r=e.length);let t=r-1;for(;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+wt[e[t]]>r?t:r},yt={string2buf:qi,buf2string:Yi,utf8border:Vi};function Xi(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Fs=Xi;const Hs=Object.prototype.toString,{Z_NO_FLUSH:Ji,Z_SYNC_FLUSH:Qi,Z_FULL_FLUSH:el,Z_FINISH:tl,Z_OK:Yt,Z_STREAM_END:rl,Z_DEFAULT_COMPRESSION:nl,Z_DEFAULT_STRATEGY:sl,Z_DEFLATED:al}=tt;function Dt(e){this.options=Qt.assign({level:nl,method:al,chunkSize:16384,windowBits:15,memLevel:8,strategy:sl},e||{});let r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Fs,this.strm.avail_out=0;let t=ht.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(t!==Yt)throw new Error(Pe[t]);if(r.header&&ht.deflateSetHeader(this.strm,r.header),r.dictionary){let n;if(typeof r.dictionary=="string"?n=yt.string2buf(r.dictionary):Hs.call(r.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(r.dictionary):n=r.dictionary,t=ht.deflateSetDictionary(this.strm,n),t!==Yt)throw new Error(Pe[t]);this._dict_set=!0}}Dt.prototype.push=function(e,r){const t=this.strm,n=this.options.chunkSize;let s,a;if(this.ended)return!1;for(r===~~r?a=r:a=r===!0?tl:Ji,typeof e=="string"?t.input=yt.string2buf(e):Hs.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),(a===Qi||a===el)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(s=ht.deflate(t,a),s===rl)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),s=ht.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Yt;if(t.avail_out===0){this.onData(t.output);continue}if(a>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};Dt.prototype.onData=function(e){this.chunks.push(e)};Dt.prototype.onEnd=function(e){e===Yt&&(this.result=Qt.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Xr(e,r){const t=new Dt(r);if(t.push(e,!0),t.err)throw t.msg||Pe[t.err];return t.result}function ol(e,r){return r=r||{},r.raw=!0,Xr(e,r)}function il(e,r){return r=r||{},r.gzip=!0,Xr(e,r)}var ll=Dt,cl=Xr,dl=ol,fl=il,ul=tt,hl={Deflate:ll,deflate:cl,deflateRaw:dl,gzip:fl,constants:ul};const Ut=16209,gl=16191;var ml=function(r,t){let n,s,a,l,i,f,c,d,x,g,h,w,O,D,S,I,E,_,L,N,b,R,C,j;const k=r.state;n=r.next_in,C=r.input,s=n+(r.avail_in-5),a=r.next_out,j=r.output,l=a-(t-r.avail_out),i=a+(r.avail_out-257),f=k.dmax,c=k.wsize,d=k.whave,x=k.wnext,g=k.window,h=k.hold,w=k.bits,O=k.lencode,D=k.distcode,S=(1<<k.lenbits)-1,I=(1<<k.distbits)-1;e:do{w<15&&(h+=C[n++]<<w,w+=8,h+=C[n++]<<w,w+=8),E=O[h&S];t:for(;;){if(_=E>>>24,h>>>=_,w-=_,_=E>>>16&255,_===0)j[a++]=E&65535;else if(_&16){L=E&65535,_&=15,_&&(w<_&&(h+=C[n++]<<w,w+=8),L+=h&(1<<_)-1,h>>>=_,w-=_),w<15&&(h+=C[n++]<<w,w+=8,h+=C[n++]<<w,w+=8),E=D[h&I];r:for(;;){if(_=E>>>24,h>>>=_,w-=_,_=E>>>16&255,_&16){if(N=E&65535,_&=15,w<_&&(h+=C[n++]<<w,w+=8,w<_&&(h+=C[n++]<<w,w+=8)),N+=h&(1<<_)-1,N>f){r.msg="invalid distance too far back",k.mode=Ut;break e}if(h>>>=_,w-=_,_=a-l,N>_){if(_=N-_,_>d&&k.sane){r.msg="invalid distance too far back",k.mode=Ut;break e}if(b=0,R=g,x===0){if(b+=c-_,_<L){L-=_;do j[a++]=g[b++];while(--_);b=a-N,R=j}}else if(x<_){if(b+=c+x-_,_-=x,_<L){L-=_;do j[a++]=g[b++];while(--_);if(b=0,x<L){_=x,L-=_;do j[a++]=g[b++];while(--_);b=a-N,R=j}}}else if(b+=x-_,_<L){L-=_;do j[a++]=g[b++];while(--_);b=a-N,R=j}for(;L>2;)j[a++]=R[b++],j[a++]=R[b++],j[a++]=R[b++],L-=3;L&&(j[a++]=R[b++],L>1&&(j[a++]=R[b++]))}else{b=a-N;do j[a++]=j[b++],j[a++]=j[b++],j[a++]=j[b++],L-=3;while(L>2);L&&(j[a++]=j[b++],L>1&&(j[a++]=j[b++]))}}else if(_&64){r.msg="invalid distance code",k.mode=Ut;break e}else{E=D[(E&65535)+(h&(1<<_)-1)];continue r}break}}else if(_&64)if(_&32){k.mode=gl;break e}else{r.msg="invalid literal/length code",k.mode=Ut;break e}else{E=O[(E&65535)+(h&(1<<_)-1)];continue t}break}}while(n<s&&a<i);L=w>>3,n-=L,w-=L<<3,h&=(1<<w)-1,r.next_in=n,r.next_out=a,r.avail_in=n<s?5+(s-n):5-(n-s),r.avail_out=a<i?257+(i-a):257-(a-i),k.hold=h,k.bits=w};const We=15,In=852,Rn=592,On=0,br=1,Un=2,pl=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_l=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),xl=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),bl=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),wl=(e,r,t,n,s,a,l,i)=>{const f=i.bits;let c=0,d=0,x=0,g=0,h=0,w=0,O=0,D=0,S=0,I=0,E,_,L,N,b,R=null,C;const j=new Uint16Array(We+1),k=new Uint16Array(We+1);let m=null,y,A,v;for(c=0;c<=We;c++)j[c]=0;for(d=0;d<n;d++)j[r[t+d]]++;for(h=f,g=We;g>=1&&j[g]===0;g--);if(h>g&&(h=g),g===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,i.bits=1,0;for(x=1;x<g&&j[x]===0;x++);for(h<x&&(h=x),D=1,c=1;c<=We;c++)if(D<<=1,D-=j[c],D<0)return-1;if(D>0&&(e===On||g!==1))return-1;for(k[1]=0,c=1;c<We;c++)k[c+1]=k[c]+j[c];for(d=0;d<n;d++)r[t+d]!==0&&(l[k[r[t+d]]++]=d);if(e===On?(R=m=l,C=20):e===br?(R=pl,m=_l,C=257):(R=xl,m=bl,C=0),I=0,d=0,c=x,b=a,w=h,O=0,L=-1,S=1<<h,N=S-1,e===br&&S>In||e===Un&&S>Rn)return 1;for(;;){y=c-O,l[d]+1<C?(A=0,v=l[d]):l[d]>=C?(A=m[l[d]-C],v=R[l[d]-C]):(A=32+64,v=0),E=1<<c-O,_=1<<w,x=_;do _-=E,s[b+(I>>O)+_]=y<<24|A<<16|v|0;while(_!==0);for(E=1<<c-1;I&E;)E>>=1;if(E!==0?(I&=E-1,I+=E):I=0,d++,--j[c]===0){if(c===g)break;c=r[t+l[d]]}if(c>h&&(I&N)!==L){for(O===0&&(O=h),b+=x,w=c-O,D=1<<w;w+O<g&&(D-=j[w+O],!(D<=0));)w++,D<<=1;if(S+=1<<w,e===br&&S>In||e===Un&&S>Rn)return 1;L=I&N,s[L]=h<<24|w<<16|b-a|0}}return I!==0&&(s[b+I]=c-O<<24|64<<16|0),i.bits=h,0};var gt=wl;const yl=0,Zs=1,Bs=2,{Z_FINISH:Tn,Z_BLOCK:vl,Z_TREES:Tt,Z_OK:Me,Z_STREAM_END:Sl,Z_NEED_DICT:El,Z_STREAM_ERROR:ce,Z_DATA_ERROR:Ws,Z_MEM_ERROR:Gs,Z_BUF_ERROR:kl,Z_DEFLATED:Pn}=tt,er=16180,zn=16181,Mn=16182,$n=16183,Fn=16184,Hn=16185,Zn=16186,Bn=16187,Wn=16188,Gn=16189,Vt=16190,xe=16191,wr=16192,qn=16193,yr=16194,Kn=16195,Yn=16196,Vn=16197,Xn=16198,Pt=16199,zt=16200,Jn=16201,Qn=16202,es=16203,ts=16204,rs=16205,vr=16206,ns=16207,ss=16208,W=16209,qs=16210,Ks=16211,Al=852,jl=592,Dl=15,Ll=Dl,as=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Nl(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const He=e=>{if(!e)return 1;const r=e.state;return!r||r.strm!==e||r.mode<er||r.mode>Ks?1:0},Ys=e=>{if(He(e))return ce;const r=e.state;return e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=er,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(Al),r.distcode=r.distdyn=new Int32Array(jl),r.sane=1,r.back=-1,Me},Vs=e=>{if(He(e))return ce;const r=e.state;return r.wsize=0,r.whave=0,r.wnext=0,Ys(e)},Xs=(e,r)=>{let t;if(He(e))return ce;const n=e.state;return r<0?(t=0,r=-r):(t=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?ce:(n.window!==null&&n.wbits!==r&&(n.window=null),n.wrap=t,n.wbits=r,Vs(e))},Js=(e,r)=>{if(!e)return ce;const t=new Nl;e.state=t,t.strm=e,t.window=null,t.mode=er;const n=Xs(e,r);return n!==Me&&(e.state=null),n},Cl=e=>Js(e,Ll);let os=!0,Sr,Er;const Il=e=>{if(os){Sr=new Int32Array(512),Er=new Int32Array(32);let r=0;for(;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(gt(Zs,e.lens,0,288,Sr,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;gt(Bs,e.lens,0,32,Er,0,e.work,{bits:5}),os=!1}e.lencode=Sr,e.lenbits=9,e.distcode=Er,e.distbits=5},Qs=(e,r,t,n)=>{let s;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(r.subarray(t-a.wsize,t),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(r.subarray(t-n,t-n+s),a.wnext),n-=s,n?(a.window.set(r.subarray(t-n,t),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},Rl=(e,r)=>{let t,n,s,a,l,i,f,c,d,x,g,h,w,O,D=0,S,I,E,_,L,N,b,R;const C=new Uint8Array(4);let j,k;const m=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(He(e)||!e.output||!e.input&&e.avail_in!==0)return ce;t=e.state,t.mode===xe&&(t.mode=wr),l=e.next_out,s=e.output,f=e.avail_out,a=e.next_in,n=e.input,i=e.avail_in,c=t.hold,d=t.bits,x=i,g=f,R=Me;e:for(;;)switch(t.mode){case er:if(t.wrap===0){t.mode=wr;break}for(;d<16;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(t.wrap&2&&c===35615){t.wbits===0&&(t.wbits=15),t.check=0,C[0]=c&255,C[1]=c>>>8&255,t.check=X(t.check,C,2,0),c=0,d=0,t.mode=zn;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",t.mode=W;break}if((c&15)!==Pn){e.msg="unknown compression method",t.mode=W;break}if(c>>>=4,d-=4,b=(c&15)+8,t.wbits===0&&(t.wbits=b),b>15||b>t.wbits){e.msg="invalid window size",t.mode=W;break}t.dmax=1<<t.wbits,t.flags=0,e.adler=t.check=1,t.mode=c&512?Gn:xe,c=0,d=0;break;case zn:for(;d<16;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(t.flags=c,(t.flags&255)!==Pn){e.msg="unknown compression method",t.mode=W;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=W;break}t.head&&(t.head.text=c>>8&1),t.flags&512&&t.wrap&4&&(C[0]=c&255,C[1]=c>>>8&255,t.check=X(t.check,C,2,0)),c=0,d=0,t.mode=Mn;case Mn:for(;d<32;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}t.head&&(t.head.time=c),t.flags&512&&t.wrap&4&&(C[0]=c&255,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,t.check=X(t.check,C,4,0)),c=0,d=0,t.mode=$n;case $n:for(;d<16;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}t.head&&(t.head.xflags=c&255,t.head.os=c>>8),t.flags&512&&t.wrap&4&&(C[0]=c&255,C[1]=c>>>8&255,t.check=X(t.check,C,2,0)),c=0,d=0,t.mode=Fn;case Fn:if(t.flags&1024){for(;d<16;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}t.length=c,t.head&&(t.head.extra_len=c),t.flags&512&&t.wrap&4&&(C[0]=c&255,C[1]=c>>>8&255,t.check=X(t.check,C,2,0)),c=0,d=0}else t.head&&(t.head.extra=null);t.mode=Hn;case Hn:if(t.flags&1024&&(h=t.length,h>i&&(h=i),h&&(t.head&&(b=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(n.subarray(a,a+h),b)),t.flags&512&&t.wrap&4&&(t.check=X(t.check,n,h,a)),i-=h,a+=h,t.length-=h),t.length))break e;t.length=0,t.mode=Zn;case Zn:if(t.flags&2048){if(i===0)break e;h=0;do b=n[a+h++],t.head&&b&&t.length<65536&&(t.head.name+=String.fromCharCode(b));while(b&&h<i);if(t.flags&512&&t.wrap&4&&(t.check=X(t.check,n,h,a)),i-=h,a+=h,b)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Bn;case Bn:if(t.flags&4096){if(i===0)break e;h=0;do b=n[a+h++],t.head&&b&&t.length<65536&&(t.head.comment+=String.fromCharCode(b));while(b&&h<i);if(t.flags&512&&t.wrap&4&&(t.check=X(t.check,n,h,a)),i-=h,a+=h,b)break e}else t.head&&(t.head.comment=null);t.mode=Wn;case Wn:if(t.flags&512){for(;d<16;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(t.wrap&4&&c!==(t.check&65535)){e.msg="header crc mismatch",t.mode=W;break}c=0,d=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=xe;break;case Gn:for(;d<32;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}e.adler=t.check=as(c),c=0,d=0,t.mode=Vt;case Vt:if(t.havedict===0)return e.next_out=l,e.avail_out=f,e.next_in=a,e.avail_in=i,t.hold=c,t.bits=d,El;e.adler=t.check=1,t.mode=xe;case xe:if(r===vl||r===Tt)break e;case wr:if(t.last){c>>>=d&7,d-=d&7,t.mode=vr;break}for(;d<3;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}switch(t.last=c&1,c>>>=1,d-=1,c&3){case 0:t.mode=qn;break;case 1:if(Il(t),t.mode=Pt,r===Tt){c>>>=2,d-=2;break e}break;case 2:t.mode=Yn;break;case 3:e.msg="invalid block type",t.mode=W}c>>>=2,d-=2;break;case qn:for(c>>>=d&7,d-=d&7;d<32;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",t.mode=W;break}if(t.length=c&65535,c=0,d=0,t.mode=yr,r===Tt)break e;case yr:t.mode=Kn;case Kn:if(h=t.length,h){if(h>i&&(h=i),h>f&&(h=f),h===0)break e;s.set(n.subarray(a,a+h),l),i-=h,a+=h,f-=h,l+=h,t.length-=h;break}t.mode=xe;break;case Yn:for(;d<14;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(t.nlen=(c&31)+257,c>>>=5,d-=5,t.ndist=(c&31)+1,c>>>=5,d-=5,t.ncode=(c&15)+4,c>>>=4,d-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=W;break}t.have=0,t.mode=Vn;case Vn:for(;t.have<t.ncode;){for(;d<3;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}t.lens[m[t.have++]]=c&7,c>>>=3,d-=3}for(;t.have<19;)t.lens[m[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,j={bits:t.lenbits},R=gt(yl,t.lens,0,19,t.lencode,0,t.work,j),t.lenbits=j.bits,R){e.msg="invalid code lengths set",t.mode=W;break}t.have=0,t.mode=Xn;case Xn:for(;t.have<t.nlen+t.ndist;){for(;D=t.lencode[c&(1<<t.lenbits)-1],S=D>>>24,I=D>>>16&255,E=D&65535,!(S<=d);){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(E<16)c>>>=S,d-=S,t.lens[t.have++]=E;else{if(E===16){for(k=S+2;d<k;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(c>>>=S,d-=S,t.have===0){e.msg="invalid bit length repeat",t.mode=W;break}b=t.lens[t.have-1],h=3+(c&3),c>>>=2,d-=2}else if(E===17){for(k=S+3;d<k;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}c>>>=S,d-=S,b=0,h=3+(c&7),c>>>=3,d-=3}else{for(k=S+7;d<k;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}c>>>=S,d-=S,b=0,h=11+(c&127),c>>>=7,d-=7}if(t.have+h>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=W;break}for(;h--;)t.lens[t.have++]=b}}if(t.mode===W)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=W;break}if(t.lenbits=9,j={bits:t.lenbits},R=gt(Zs,t.lens,0,t.nlen,t.lencode,0,t.work,j),t.lenbits=j.bits,R){e.msg="invalid literal/lengths set",t.mode=W;break}if(t.distbits=6,t.distcode=t.distdyn,j={bits:t.distbits},R=gt(Bs,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,j),t.distbits=j.bits,R){e.msg="invalid distances set",t.mode=W;break}if(t.mode=Pt,r===Tt)break e;case Pt:t.mode=zt;case zt:if(i>=6&&f>=258){e.next_out=l,e.avail_out=f,e.next_in=a,e.avail_in=i,t.hold=c,t.bits=d,ml(e,g),l=e.next_out,s=e.output,f=e.avail_out,a=e.next_in,n=e.input,i=e.avail_in,c=t.hold,d=t.bits,t.mode===xe&&(t.back=-1);break}for(t.back=0;D=t.lencode[c&(1<<t.lenbits)-1],S=D>>>24,I=D>>>16&255,E=D&65535,!(S<=d);){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(I&&!(I&240)){for(_=S,L=I,N=E;D=t.lencode[N+((c&(1<<_+L)-1)>>_)],S=D>>>24,I=D>>>16&255,E=D&65535,!(_+S<=d);){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}c>>>=_,d-=_,t.back+=_}if(c>>>=S,d-=S,t.back+=S,t.length=E,I===0){t.mode=rs;break}if(I&32){t.back=-1,t.mode=xe;break}if(I&64){e.msg="invalid literal/length code",t.mode=W;break}t.extra=I&15,t.mode=Jn;case Jn:if(t.extra){for(k=t.extra;d<k;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}t.length+=c&(1<<t.extra)-1,c>>>=t.extra,d-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Qn;case Qn:for(;D=t.distcode[c&(1<<t.distbits)-1],S=D>>>24,I=D>>>16&255,E=D&65535,!(S<=d);){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(!(I&240)){for(_=S,L=I,N=E;D=t.distcode[N+((c&(1<<_+L)-1)>>_)],S=D>>>24,I=D>>>16&255,E=D&65535,!(_+S<=d);){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}c>>>=_,d-=_,t.back+=_}if(c>>>=S,d-=S,t.back+=S,I&64){e.msg="invalid distance code",t.mode=W;break}t.offset=E,t.extra=I&15,t.mode=es;case es:if(t.extra){for(k=t.extra;d<k;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}t.offset+=c&(1<<t.extra)-1,c>>>=t.extra,d-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=W;break}t.mode=ts;case ts:if(f===0)break e;if(h=g-f,t.offset>h){if(h=t.offset-h,h>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=W;break}h>t.wnext?(h-=t.wnext,w=t.wsize-h):w=t.wnext-h,h>t.length&&(h=t.length),O=t.window}else O=s,w=l-t.offset,h=t.length;h>f&&(h=f),f-=h,t.length-=h;do s[l++]=O[w++];while(--h);t.length===0&&(t.mode=zt);break;case rs:if(f===0)break e;s[l++]=t.length,f--,t.mode=zt;break;case vr:if(t.wrap){for(;d<32;){if(i===0)break e;i--,c|=n[a++]<<d,d+=8}if(g-=f,e.total_out+=g,t.total+=g,t.wrap&4&&g&&(e.adler=t.check=t.flags?X(t.check,s,g,l-g):bt(t.check,s,g,l-g)),g=f,t.wrap&4&&(t.flags?c:as(c))!==t.check){e.msg="incorrect data check",t.mode=W;break}c=0,d=0}t.mode=ns;case ns:if(t.wrap&&t.flags){for(;d<32;){if(i===0)break e;i--,c+=n[a++]<<d,d+=8}if(t.wrap&4&&c!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=W;break}c=0,d=0}t.mode=ss;case ss:R=Sl;break e;case W:R=Ws;break e;case qs:return Gs;case Ks:default:return ce}return e.next_out=l,e.avail_out=f,e.next_in=a,e.avail_in=i,t.hold=c,t.bits=d,(t.wsize||g!==e.avail_out&&t.mode<W&&(t.mode<vr||r!==Tn))&&Qs(e,e.output,e.next_out,g-e.avail_out),x-=e.avail_in,g-=e.avail_out,e.total_in+=x,e.total_out+=g,t.total+=g,t.wrap&4&&g&&(e.adler=t.check=t.flags?X(t.check,s,g,e.next_out-g):bt(t.check,s,g,e.next_out-g)),e.data_type=t.bits+(t.last?64:0)+(t.mode===xe?128:0)+(t.mode===Pt||t.mode===yr?256:0),(x===0&&g===0||r===Tn)&&R===Me&&(R=kl),R},Ol=e=>{if(He(e))return ce;let r=e.state;return r.window&&(r.window=null),e.state=null,Me},Ul=(e,r)=>{if(He(e))return ce;const t=e.state;return t.wrap&2?(t.head=r,r.done=!1,Me):ce},Tl=(e,r)=>{const t=r.length;let n,s,a;return He(e)||(n=e.state,n.wrap!==0&&n.mode!==Vt)?ce:n.mode===Vt&&(s=1,s=bt(s,r,t,0),s!==n.check)?Ws:(a=Qs(e,r,t,t),a?(n.mode=qs,Gs):(n.havedict=1,Me))};var Pl=Vs,zl=Xs,Ml=Ys,$l=Cl,Fl=Js,Hl=Rl,Zl=Ol,Bl=Ul,Wl=Tl,Gl="pako inflate (from Nodeca project)",we={inflateReset:Pl,inflateReset2:zl,inflateResetKeep:Ml,inflateInit:$l,inflateInit2:Fl,inflate:Hl,inflateEnd:Zl,inflateGetHeader:Bl,inflateSetDictionary:Wl,inflateInfo:Gl};function ql(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Kl=ql;const ea=Object.prototype.toString,{Z_NO_FLUSH:Yl,Z_FINISH:Vl,Z_OK:vt,Z_STREAM_END:kr,Z_NEED_DICT:Ar,Z_STREAM_ERROR:Xl,Z_DATA_ERROR:is,Z_MEM_ERROR:Jl}=tt;function Lt(e){this.options=Qt.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15||(r.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Fs,this.strm.avail_out=0;let t=we.inflateInit2(this.strm,r.windowBits);if(t!==vt)throw new Error(Pe[t]);if(this.header=new Kl,we.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=yt.string2buf(r.dictionary):ea.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(t=we.inflateSetDictionary(this.strm,r.dictionary),t!==vt)))throw new Error(Pe[t])}Lt.prototype.push=function(e,r){const t=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,l,i;if(this.ended)return!1;for(r===~~r?l=r:l=r===!0?Vl:Yl,ea.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(n),t.next_out=0,t.avail_out=n),a=we.inflate(t,l),a===Ar&&s&&(a=we.inflateSetDictionary(t,s),a===vt?a=we.inflate(t,l):a===is&&(a=Ar));t.avail_in>0&&a===kr&&t.state.wrap>0&&e[t.next_in]!==0;)we.inflateReset(t),a=we.inflate(t,l);switch(a){case Xl:case is:case Ar:case Jl:return this.onEnd(a),this.ended=!0,!1}if(i=t.avail_out,t.next_out&&(t.avail_out===0||a===kr))if(this.options.to==="string"){let f=yt.utf8border(t.output,t.next_out),c=t.next_out-f,d=yt.buf2string(t.output,f);t.next_out=c,t.avail_out=n-c,c&&t.output.set(t.output.subarray(f,f+c),0),this.onData(d)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(a===vt&&i===0)){if(a===kr)return a=we.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Lt.prototype.onData=function(e){this.chunks.push(e)};Lt.prototype.onEnd=function(e){e===vt&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Qt.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Jr(e,r){const t=new Lt(r);if(t.push(e),t.err)throw t.msg||Pe[t.err];return t.result}function Ql(e,r){return r=r||{},r.raw=!0,Jr(e,r)}var ec=Lt,tc=Jr,rc=Ql,nc=Jr,sc=tt,ac={Inflate:ec,inflate:tc,inflateRaw:rc,ungzip:nc,constants:sc};const{Deflate:fd,deflate:oc,deflateRaw:ud,gzip:hd}=hl,{Inflate:gd,inflate:ic,inflateRaw:md,ungzip:pd}=ac;var lc=oc,cc=ic;const dc=e=>{try{const r=new TextEncoder().encode(e),t=lc(r,{level:9});return uc(t)}catch(r){return console.error("Compression failed:",r),e}},fc=e=>{try{const r=hc(e),t=cc(new Uint8Array(r));return new TextDecoder().decode(t)}catch(r){return console.error("Decompression failed:",r),e}},uc=e=>{const r=e instanceof Uint8Array?e:new Uint8Array(e);let t="";for(let n=0;n<r.byteLength;n++)t+=String.fromCharCode(r[n]);return btoa(t)},hc=e=>{const r=atob(e),t=r.length,n=new Uint8Array(t);for(let s=0;s<t;s++)n[s]=r.charCodeAt(s);return n.buffer},Bt={minLength:8,requireUppercase:!1,requireLowercase:!1,requireNumbers:!0,requireSpecialChars:!1,maxAge:90,preventCommonPasswords:!1,preventSequentialChars:!1,preventRepeatedChars:!1,HISTORY_SIZE:5},ta=["password","admin","123456","qwerty","welcome","123456789","12345678","12345","1234567890","abc123","football","iloveyou","1234567","letmein","trustno1","dragon","baseball","sunshine","princess","superman","batman","master","welcome123","admin123","passw0rd"],gc=(e,r=Bt)=>{if(e.length<r.minLength)return{valid:!1,message:`Password must be at least ${r.minLength} characters long`,strength:1};const t=/[A-Z]/.test(e);if(r.requireUppercase&&!t)return{valid:!1,message:"Password must contain at least one uppercase letter",strength:Ne(e)};const n=/[a-z]/.test(e);if(r.requireLowercase&&!n)return{valid:!1,message:"Password must contain at least one lowercase letter",strength:Ne(e)};const s=/[0-9]/.test(e);if(r.requireNumbers&&!s)return{valid:!1,message:"Password must contain at least one number",strength:Ne(e)};const a=/[^A-Za-z0-9]/.test(e);return r.requireSpecialChars&&!a?{valid:!1,message:"Password must contain at least one special character",strength:Ne(e)}:r.preventCommonPasswords&&ta.includes(e.toLowerCase())?{valid:!1,message:"Password is too common and easily guessable",strength:1}:r.preventSequentialChars&&ra(e)?{valid:!1,message:"Password contains sequential characters",strength:Ne(e)}:r.preventRepeatedChars&&na(e)?{valid:!1,message:"Password contains too many repeated characters",strength:Ne(e)}:{valid:!0,message:"Password meets all requirements",strength:Ne(e)}},Ne=e=>{let r=0;e.length>=8&&(r+=1),e.length>=12&&(r+=1),e.length>=16&&(r+=1);const t=/[A-Z]/.test(e),n=/[a-z]/.test(e),s=/[0-9]/.test(e),a=/[^A-Za-z0-9]/.test(e),l=[t,n,s,a].filter(Boolean).length;return r+=l/2,ra(e)&&(r-=1),na(e)&&(r-=1),ta.some(i=>e.toLowerCase().includes(i))&&(r-=1),Math.max(1,Math.min(5,Math.round(r)))},ra=e=>{const r=["0123456789","abcdefghijklmnopqrstuvwxyz","qwertyuiop","asdfghjkl","zxcvbnm"],t=e.toLowerCase();for(const n of r)for(let s=0;s<n.length-2;s++){const a=n.slice(s,s+3);if(t.includes(a))return!0}return!1},na=e=>/(.)\1{2,}/.test(e),sa="hipaa-compliant-auth-system-key",Wt="secure_auth_db",aa="secure_auth_logs";let K=new Map,H=null,Je=!1;const jr="keeseetyler@yahoo.com",ls="Admin123!",Dr={users:[],currentUser:null,schemaVersion:1,lastUpdated:Date.now(),auditLogs:[],recoveryTokens:[]},oa=e=>{try{const r=dc(JSON.stringify(e));return ge.AES.encrypt(r,sa,{mode:ge.mode.CBC,padding:ge.pad.Pkcs7}).toString()}catch(r){throw console.error("Encryption error:",r),new Error("Failed to encrypt data")}},ia=e=>{try{const t=ge.AES.decrypt(e,sa,{mode:ge.mode.CBC,padding:ge.pad.Pkcs7}).toString(ge.enc.Utf8),n=fc(t);return JSON.parse(n)}catch(r){return console.error("Error decrypting data:",r),null}},la=e=>oa(e),ca=e=>ia(e),Ge=e=>{K.clear(),e.users.forEach(r=>{K.set(r.email.toLowerCase(),r.id)}),e.currentUser?H=e.users.find(r=>r.id===e.currentUser)||null:H=null,Je=!0},G=()=>{try{const e=localStorage.getItem(Wt);if(!e){const l={...Dr},i="keeseetyler@yahoo.com",{hash:f,salt:c}=te("admin123"),d=Date.now(),x={id:oe(),email:i,passwordHash:f,salt:c,role:"admin",createdAt:d,passwordLastChanged:d,passwordHistory:[{hash:f,salt:c,timestamp:d}],failedLoginAttempts:0,mfaEnabled:!1,metadata:{}};return l.users.push(x),Ge(l),F(l),console.log("Created new database with admin account"),l}let r=null;try{r=ca(e)}catch(l){return console.error("Failed to decrypt database, creating new one:",l),localStorage.removeItem(Wt),G()}if(!r)return console.error("Failed to decrypt database"),localStorage.removeItem(Wt),G();const t={...Dr,...r};Ge(t);const n="keeseetyler@yahoo.com";let s=!1;const a=K.get(n.toLowerCase());if((!a||!t.users.some(l=>l.id===a))&&(s=!0),t.users.forEach(l=>{(!l.role||!l.passwordHash||!l.salt)&&(s=!0)}),s){console.log("Database corruption detected, auto-repairing...");let l=t.users.find(i=>i.email.toLowerCase()===n.toLowerCase());if(l)l.role="admin";else{const{hash:i,salt:f}=te("admin123"),c=Date.now();l={id:oe(),email:n,passwordHash:i,salt:f,role:"admin",createdAt:c,passwordLastChanged:c,passwordHistory:[{hash:i,salt:f,timestamp:c}],failedLoginAttempts:0,mfaEnabled:!1,metadata:{}},t.users.push(l)}t.users=t.users.map(i=>{if(i.role||(i.role="user"),!i.passwordHash||!i.salt){const{hash:f,salt:c}=te("default123");i.passwordHash=f,i.salt=c}return i}),Ge(t),F(t),console.log("Database auto-repaired")}return t}catch(e){console.error("Error loading database:",e);const r={...Dr};return Ge(r),r}},F=e=>{try{e.lastUpdated=Date.now(),Ge(e);const r=la(e);return localStorage.setItem(Wt,r),!0}catch(r){return console.error("Error saving database:",r),!1}},te=e=>{const r=ge.lib.WordArray.random(32).toString();return{hash:ge.PBKDF2(e,r,{keySize:256/32,iterations:1e4}).toString(),salt:r}},St=(e,r,t)=>ge.PBKDF2(e,t,{keySize:8,iterations:1e4}).toString()===r,Nt=()=>{try{const e=localStorage.getItem(aa);if(!e)return[];const r=ca(e);return r||(console.error("Failed to decrypt logs"),[])}catch(e){return console.error("Error loading logs:",e),[]}},Qr=e=>{try{const r=la(e);return localStorage.setItem(aa,r),!0}catch(r){return console.error("Error saving logs:",r),!1}},st=()=>{if(Je&&H)return H;try{const e=G();return e.currentUser?(H=e.users.find(t=>t.id===e.currentUser)||null,H):null}catch(e){return console.error("Error getting current user:",e),null}},P=(e,r,t)=>{try{const n=Nt(),s=st(),a={id:oe(),timestamp:Date.now(),level:e,user:s?.email,action:r,details:t};n.unshift(a);const l=2e3;return n.length>l&&(n.length=l),Qr(n),console.log(`[${e.toUpperCase()}] ${r}`,t||""),a}catch(n){return console.error("Failed to write log:",n),{id:oe(),timestamp:Date.now(),level:"error",action:"log_failure",details:{error:n.message}}}},en=e=>e.toLowerCase().trim()==="keeseetyler@yahoo.com",tn=(e,r)=>{try{const t=G(),n=e.toLowerCase();if(K.has(n)){const c=K.get(n),d=t.users.find(x=>x.id===c);if(d)return d}const{hash:s,salt:a}=te(r),l=Date.now(),i=en(n),f={id:oe(),email:e,passwordHash:s,salt:a,role:i?"admin":"user",createdAt:l,passwordLastChanged:l,passwordHistory:[{hash:s,salt:a,timestamp:l}],failedLoginAttempts:0,mfaEnabled:!1,metadata:{}};return t.users.push(f),K.set(n,f.id),F(t),P("info","User created",{email:e,role:f.role}),f}catch(t){return P("error","Error creating user",{error:t.message,email:e}),null}},da=(e,r)=>{try{console.log(`Authentication attempt for: ${e}`);const t=G(),n=e.toLowerCase();if(n==="keeseetyler@yahoo.com"){console.log(`Admin login attempt detected for: ${e}`);const l=K.get(n);let i=l?t.users.find(f=>f.id===l):null;if(!i){console.log(`Admin user ${e} doesn't exist, creating...`);const{hash:f,salt:c}=te(r||"admin123"),d=Date.now(),x={id:oe(),email:e,passwordHash:f,salt:c,role:"admin",createdAt:d,passwordLastChanged:d,passwordHistory:[{hash:f,salt:c,timestamp:d}],failedLoginAttempts:0,mfaEnabled:!1,metadata:{}};return t.users.push(x),K.set(n,x.id),F(t),H=x,t.currentUser=x.id,F(t),console.log(`Created and authenticated new admin user: ${e}`),x}return i.role="admin",i.lastLogin=Date.now(),t.currentUser=i.id,H=i,F(t),console.log(`Admin ${e} authenticated successfully`),i}else if(en(n)){console.log(`Other admin login attempt detected for: ${e}`);const l=K.get(n);let i=l?t.users.find(f=>f.id===l):null;if(!i){console.log(`Admin user ${e} doesn't exist, creating...`);const{hash:f,salt:c}=te(r),d=Date.now(),x={id:oe(),email:e,passwordHash:f,salt:c,role:"admin",createdAt:d,passwordLastChanged:d,passwordHistory:[{hash:f,salt:c,timestamp:d}],failedLoginAttempts:0,mfaEnabled:!1,metadata:{}};return t.users.push(x),K.set(n,x.id),F(t),H=x,t.currentUser=x.id,F(t),console.log(`Created and authenticated new admin user: ${e}`),x}if(!St(r,i.passwordHash,i.salt)){console.log(`Updating admin password for: ${e}`);const{hash:f,salt:c}=te(r);i.passwordHash=f,i.salt=c,i.passwordLastChanged=Date.now(),F(t)}return i.lastLogin=Date.now(),t.currentUser=i.id,H=i,F(t),console.log(`Admin ${e} authenticated successfully`),i}const s=K.get(n);if(!s){console.log(`User ${e} doesn't exist, creating...`);const l=tn(e,r);return l?(t.currentUser=l.id,H=l,F(t),l):null}const a=t.users.find(l=>l.id===s);if(!a)return P("warning","Authentication failed - user not found despite index",{email:e}),console.log(`User found in index but not in database: ${e}`),null;if(!St(r,a.passwordHash,a.salt)){console.log(`Updating password for: ${e}`);const{hash:l,salt:i}=te(r);a.passwordHash=l,a.salt=i,a.passwordLastChanged=Date.now()}return a.failedLoginAttempts=0,a.lockedUntil=void 0,a.lastLogin=Date.now(),t.currentUser=a.id,H=a,F(t),P("info","User authenticated",{email:e,userId:a.id}),console.log(`User authenticated successfully: ${e}`),a}catch(t){return console.error("Error during authentication:",t),P("error","Error authenticating user",{error:t.message,email:e}),null}},mc=()=>st()?.role==="admin"||!1,fa=e=>{try{const r=G(),t=e.toLowerCase(),n=K.get(t);return n&&r.users.find(s=>s.id===n)||null}catch(r){return P("error","Error getting user by email",{error:r.message,email:e}),null}},Gt=()=>{try{return G().users.map(r=>({...r,passwordHash:"[REDACTED]",salt:"[REDACTED]",mfaSecret:r.mfaSecret?"[REDACTED]":void 0}))}catch(e){return P("error","Error getting all users",{error:e.message}),[]}},pc=()=>{try{const e=st();e&&P("info","User logged out",{email:e.email});const r=G();r.currentUser=null,H=null,F(r)}catch(e){P("error","Error logging out user",{error:e.message})}},ye=(e,r)=>P("info",e,r),ct=(e=200,r=0)=>{try{const t=Nt();if(e===0||t.length<=e)return t;const n=r*e,s=n+e;return t.slice(n,s)}catch(t){return P("error","Error retrieving logs",{error:t.message}),[]}},dt=()=>{try{return Nt().length}catch(e){return P("error","Error getting log count",{error:e.message}),0}},_c=()=>{try{const e=G(),r={...e,users:e.users.map(t=>({...t,passwordHash:"[REDACTED]",salt:"[REDACTED]",mfaSecret:t.mfaSecret?"[REDACTED]":void 0}))};return JSON.stringify(r,null,2)}catch(e){return P("error","Error exporting database",{error:e.message}),null}},xc=e=>{try{const r=JSON.parse(e);if(!r||typeof r!="object")return P("error","Invalid database format during import - not an object"),!1;if(!r.users||!Array.isArray(r.users))return P("error","Invalid database format during import - users not found or not an array"),!1;if(typeof r.schemaVersion!="number")return P("error","Invalid database format during import - schema version missing"),!1;for(const i of r.users)if(!i.id||!i.email||!i.role||!i.createdAt)return P("error","Invalid user data during import",{user:i}),!1;const t=G(),n=new Set(t.users.map(i=>i.id)),s=new Set(t.users.map(i=>i.email.toLowerCase())),a=r.users.filter(i=>!n.has(i.id)&&!s.has(i.email.toLowerCase()));a.forEach(i=>{i.role==="admin"&&i.email.toLowerCase()!=="keeseetyler@yahoo.com"&&(i.role="user",P("warning","Downgraded imported admin to regular user",{email:i.email}))}),t.users=[...t.users,...a];const l=F(t);return l&&P("info","Database imported successfully",{newUsersCount:a.length,totalUsers:t.users.length}),l}catch(r){return P("error","Error importing database",{error:r.message}),!1}},bc=e=>{try{const r=G(),t=r.users.findIndex(n=>n.email.toLowerCase()===e.toLowerCase());if(t===-1){if(console.error(`User with email ${e} not found`),en(e.toLowerCase())){const{hash:n,salt:s}=te("tempPassword123!"),a=Date.now(),l={id:oe(),email:e,passwordHash:n,salt:s,role:"admin",createdAt:a,passwordLastChanged:a,passwordHistory:[{hash:n,salt:s,timestamp:a}],failedLoginAttempts:0,mfaEnabled:!1,metadata:{}};return r.users.push(l),K.set(e.toLowerCase(),l.id),F(r),console.log(`Created new admin user ${e}`),!0}return!1}return r.users[t].role="admin",F(r),Je=!1,Ge(r),r.currentUser===r.users[t].id&&(H=r.users[t],localStorage.setItem("auth_user",JSON.stringify(r.users[t]))),P("info","user_role_changed",{email:e,role:"admin"}),console.log(`User ${e} is now an admin`),!0}catch(r){return console.error("Failed to make user admin:",r),!1}},wc=(e,r,t=[])=>{try{const n=G(),s=n.users.findIndex(i=>i.id===e);if(s===-1)return console.warn(`User with ID ${e} not found for MFA enablement`),!1;n.users[s].mfaEnabled=!0,n.users[s].mfaSecret=r,t&&t.length>0&&(n.users[s].recoveryCodes=t);const a={id:oe(),timestamp:Date.now(),level:"info",user:n.users[s].email,action:"MFA enabled",details:{userId:e}},l=Nt();return l.unshift(a),Qr(l),F(n),console.info(`MFA enabled for user ${n.users[s].email}`),!0}catch(n){return console.error("Error enabling MFA:",n),!1}},yc=e=>{try{const r=G(),t=r.users.find(n=>n.id===e);return t?(t.mfaEnabled=!1,t.mfaSecret=void 0,H&&H.id===e&&(H.mfaEnabled=!1,H.mfaSecret=void 0),F(r),P("info","MFA disabled for user",{email:t.email}),!0):(P("error","Failed to disable MFA - user not found",{userId:e}),!1)}catch(r){return P("error","Error disabling MFA",{error:r.message,userId:e}),!1}},vc=(e,r,t)=>{try{const n=G(),s=n.users.find(f=>f.id===e);if(!s)return P("error","Failed to change password - user not found",{userId:e}),"User not found";if(!St(r,s.passwordHash,s.salt))return P("warning","Password change failed - current password incorrect",{email:s.email}),"Current password is incorrect";const a=gc(t,Bt);if(!a.valid)return P("warning","Password change failed - policy violation",{email:s.email,reason:a.message}),a.message||"Password does not meet requirements";if(s.passwordHistory&&s.passwordHistory.length>0){for(const f of s.passwordHistory)if(St(t,f.hash,f.salt))return P("warning","Password change failed - password reuse",{email:s.email}),"Cannot reuse a previous password"}const{hash:l,salt:i}=te(t);return s.passwordHash=l,s.salt=i,s.passwordLastChanged=Date.now(),s.passwordHistory||(s.passwordHistory=[]),s.passwordHistory.unshift({hash:l,salt:i,timestamp:Date.now()}),s.passwordHistory.length>Bt.HISTORY_SIZE&&(s.passwordHistory.length=Bt.HISTORY_SIZE),H&&H.id===e&&(H.passwordHash=l,H.salt=i,H.passwordLastChanged=s.passwordLastChanged,H.passwordHistory=s.passwordHistory),F(n),P("info","Password changed for user",{email:s.email}),!0}catch(n){return P("error","Error changing password",{error:n.message,userId:e}),"An error occurred while changing password"}},Sc=async()=>{try{const e=G(),r=Nt();return{userCount:e.users.length,adminCount:e.users.filter(t=>t.role==="admin").length,mfaEnabledCount:e.users.filter(t=>t.mfaEnabled).length,logCount:r.length,dbSizeKB:JSON.stringify(e).length/1024}}catch(e){return console.error("Error getting database stats:",e),{userCount:0,adminCount:0,mfaEnabledCount:0,logCount:0,dbSizeKB:0}}},ua=()=>{if(!Je){const e=G();if(e.users.length===0){P("info","Database initialized"),console.log("Creating default admin account");const{hash:r,salt:t}=te(ls),n={id:crypto.randomUUID?crypto.randomUUID():`admin-${Date.now()}`,email:jr,passwordHash:r,salt:t,role:"admin",createdAt:Date.now(),mfaEnabled:!1,passwordLastChanged:Date.now(),name:"System Administrator"};e.users.push(n),e.auditLogs.push({id:crypto.randomUUID?crypto.randomUUID():`log-${Date.now()}`,timestamp:Date.now(),action:"system_init",level:"info",details:{message:"System initialized with default admin account"}})}else if(!e.users.some(t=>t.email.toLowerCase()===jr.toLowerCase())){console.log("Adding missing admin account");const{hash:t,salt:n}=te(ls),s={id:crypto.randomUUID?crypto.randomUUID():`admin-${Date.now()}`,email:jr,passwordHash:t,salt:n,role:"admin",createdAt:Date.now(),mfaEnabled:!1,passwordLastChanged:Date.now(),name:"System Administrator"};e.users.push(s),e.auditLogs.push({id:crypto.randomUUID?crypto.randomUUID():`log-${Date.now()}`,timestamp:Date.now(),action:"admin_account_added",level:"info",details:{message:"Default admin account created"}})}F(e),Je=!0}};ua();const rn=async e=>{try{const r=await G();if(!e.action)throw new Error("Audit log must have an action");const t={id:e.id||oe(),userId:e.userId,timestamp:e.timestamp||Date.now(),action:e.action,level:e.level||"info",details:e.details||{}};return r.auditLogs.push(t),r.auditLogs.length>1e3&&(r.auditLogs=r.auditLogs.slice(-1e3)),await F(r),t}catch(r){throw console.error("Error adding audit log:",r),r}},Ec=async e=>{let t=[...(await G()).auditLogs];e?.userId&&(t=t.filter(s=>s.userId===e.userId)),e?.level&&(t=t.filter(s=>s.level===e.level)),e?.action&&(t=t.filter(s=>s.action.includes(e.action))),e?.startTime&&(t=t.filter(s=>s.timestamp>=e.startTime)),e?.endTime&&(t=t.filter(s=>s.timestamp<=e.endTime)),t.sort((s,a)=>a.timestamp-s.timestamp);const n=t.length;return e?.offset!==void 0&&e?.limit!==void 0?t=t.slice(e.offset,e.offset+e.limit):e?.limit!==void 0&&(t=t.slice(0,e.limit)),{logs:t,total:n}},Hr=(e,r)=>{try{const t=G(),n=t.users.findIndex(s=>s.id===e);return n===-1?void 0:(t.users[n]={...t.users[n],...r},F(t),t.users[n])}catch(t){P("error","Error updating user",{error:t.message,userId:e});return}},kc=async e=>{const r=await G(),t=r.users.findIndex(s=>s.id===e);if(t===-1)return!1;const n=r.users[t].email;return r.users.splice(t,1),await F(r),await rn({action:"user_deleted",timestamp:Date.now(),level:"warning",details:{userId:e,email:n}}),!0},Ac=()=>{try{console.log("Deleting all accounts and resetting database...");const e={users:[],currentUser:null,schemaVersion:1,lastUpdated:Date.now(),auditLogs:[],recoveryTokens:[]},r=F(e);return K.clear(),H=null,Je=!1,Qr([]),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_session_expiry"),console.log("Database reset successfully!"),r}catch(e){return console.error("Error resetting database:",e),!1}},jc=e=>{if(e.toLowerCase().trim()!=="keeseetyler@yahoo.com")return null;try{const r=G(),t=e.toLowerCase().trim(),n=K.get(t);let s=n?r.users.find(a=>a.id===n):null;if(!s){console.log(`Creating emergency admin account for ${e}`);const{hash:a,salt:l}=te("admin123"),i=Date.now(),f={id:oe(),email:e,passwordHash:a,salt:l,role:"admin",createdAt:i,passwordLastChanged:i,passwordHistory:[{hash:a,salt:l,timestamp:i}],failedLoginAttempts:0,mfaEnabled:!1,metadata:{}};return r.users.push(f),K.set(t,f.id),H=f,r.currentUser=f.id,F(r),P("info","Emergency admin account created",{email:e}),f}return s.role!=="admin"&&(s.role="admin",F(r),P("info","User promoted to admin",{email:e})),r.currentUser=s.id,H=s,F(r),s}catch(r){return console.error("Error ensuring admin access:",r),null}},Dc=()=>{try{console.log("Checking database for corruption...");const e=G();let r=!1;e.users.forEach(a=>{const l=a.email.toLowerCase(),i=K.get(l);if((!i||i!==a.id)&&(console.log(`Fixing index for user: ${a.email}`),K.set(l,a.id),r=!0),a.role||(console.log(`Fixing missing role for user: ${a.email}`),a.role=a.email.toLowerCase()==="keeseetyler@yahoo.com"?"admin":"user",r=!0),!a.passwordHash||!a.salt){console.log(`Fixing missing password hash for user: ${a.email}`);const{hash:f,salt:c}=te("default123");a.passwordHash=f,a.salt=c,r=!0}a.email.toLowerCase()==="keeseetyler@yahoo.com"&&a.role!=="admin"&&(console.log(`Ensuring admin role for ${a.email}`),a.role="admin",r=!0)});const t="keeseetyler@yahoo.com",n=K.get(t.toLowerCase());if(!(!!n&&e.users.some(a=>a.id===n))){console.log("Creating missing admin user");const{hash:a,salt:l}=te("admin123"),i=Date.now(),f={id:oe(),email:t,passwordHash:a,salt:l,role:"admin",createdAt:i,passwordLastChanged:i,passwordHistory:[{hash:a,salt:l,timestamp:i}],failedLoginAttempts:0,mfaEnabled:!1,metadata:{}};e.users.push(f),K.set(t.toLowerCase(),f.id),r=!0}return r?(console.log("Database repaired successfully"),F(e),!0):(console.log("No database repairs needed"),!1)}catch(e){return console.error("Error repairing database:",e),!1}},Et={requireMfa:!1,enforcePasswordPolicy:!1,enablePasswordless:!1,logFailedLogins:!0,lockAccountAfterFailures:!1,sessionTimeout:60,enableDetailedLogs:!0,retainLogsForDays:365,enableAuditAlerts:!1,enableSsoIntegration:!1,apiRateLimit:100,enableAnalytics:!1},ha="admin_system_settings",nn=()=>{try{const e=localStorage.getItem(ha);return e?JSON.parse(e):Et}catch(e){return console.error("Error retrieving system settings:",e),Et}},ga=e=>{try{return localStorage.setItem(ha,JSON.stringify(e)),ye("system_settings_updated",{updatedBy:st()?.email||"unknown",settings:e}),!0}catch(r){return console.error("Error saving system settings:",r),!1}},Lc=e=>{const r=nn();return typeof r[e]=="boolean"?r[e]:!1},cs=Object.freeze(Object.defineProperty({__proto__:null,addAuditLog:rn,authenticateUser:da,changePassword:vc,createUser:tn,decrypt:ia,defaultSystemSettings:Et,deleteAllAccounts:Ac,deleteUser:kc,disableMFA:yc,enableMFA:wc,encrypt:oa,ensureAdminAccess:jc,exportDatabase:_c,getAllLogs:ct,getAllUsers:Gt,getAuditLogs:Ec,getCurrentUser:st,getDatabase:G,getDatabaseStats:Sc,getLogCount:dt,getSystemSettings:nn,getUserByEmail:fa,hashPassword:te,importDatabase:xc,initializeDatabase:ua,isAdmin:mc,isFeatureEnabled:Lc,logAction:ye,logoutUser:pc,makeUserAdmin:bc,repairDatabase:Dc,saveDatabase:F,saveSystemSettings:ga,updateUser:Hr,verifyPassword:St},Symbol.toStringTag,{value:"Module"})),ds=async e=>!!fa(e)?.mfaEnabled,sn=p.createContext({user:null,loading:!1,error:null,isAuthenticated:!1,isAdmin:!1,login:async()=>({success:!1,error:"Not implemented"}),logout:()=>{},register:async()=>({success:!1,error:"Not implemented"}),updateUser:async()=>{},refreshUser:async()=>{},checkMfaRequired:async()=>!1,sendPasswordRecoveryEmail:async()=>({success:!1,error:"Not implemented"}),resetPassword:async()=>({success:!1,message:"Not implemented"}),verifyResetToken:async()=>!1,confirmPasswordReset:async()=>!1,getSessionTimeRemaining:()=>0,extendSession:()=>{},startPasswordlessLogin:async()=>({success:!1,error:"Not implemented"}),verifyPasswordlessCode:async()=>({success:!1,error:"Not implemented"}),getSSOProviders:()=>[],initiateSSOLogin:async()=>({url:null,error:"Not implemented"}),handleSSOCallback:async()=>({success:!1,error:"Not implemented"})}),Ce=60*60*1e3,Nc=({children:e})=>{const[r,t]=p.useState(null),[n,s]=p.useState(!1),[a,l]=p.useState(null),[i,f]=p.useState(null),c=p.useRef(null),d=p.useRef(null);p.useEffect(()=>{c.current=r,d.current=i},[r,i]);const x=p.useCallback(()=>{console.log("Logging out user..."),c.current&&V(Y.LOGOUT,{userId:c.current.id,timestamp:new Date().toISOString()}),t(null),f(null),localStorage.removeItem("authToken"),localStorage.removeItem("sessionExpiry"),console.log("Logout completed")},[]);p.useEffect(()=>{console.log("Initializing auth state from localStorage");const m=localStorage.getItem("sessionExpiry"),y=localStorage.getItem("authUser");if(m&&y){const A=parseInt(m,10);if(A>Date.now())try{const v=JSON.parse(y);t(v),f(A),console.log("Restored user session from localStorage")}catch(v){console.error("Error parsing stored user data:",v),localStorage.removeItem("authUser"),localStorage.removeItem("sessionExpiry")}else console.log("Stored session expired, cleaning up"),localStorage.removeItem("authUser"),localStorage.removeItem("sessionExpiry")}},[]),p.useEffect(()=>{console.log("Setting up session expiry timer");const m=()=>{const A=d.current,v=c.current;return console.log("Checking session expiry:",A,"Current time:",Date.now()),v&&A&&A<Date.now()?(console.log("Session expired, logging out"),x(),!0):!1};m();const y=setInterval(m,6e4);return()=>{clearInterval(y)}},[x]),p.useCallback(()=>i&&i<Date.now()?(x(),!0):!1,[i,x]);const g=async(m,y)=>{s(!0),l(null),V(Y.LOGIN_ATTEMPT,{email:m,timestamp:new Date().toISOString()});try{if(await ds(m)&&!y)return console.log("MFA is required for this account"),s(!1),{success:!1,error:"MFA required",requiresMfa:!0};const A=da(m,y);if(!A)return s(!1),{success:!1,error:"Invalid email or password"};const v=Mt(A);return console.log("AuthProvider: Login successful, user:",v),t(v),f(Date.now()+Ce),ye("user_login",{email:v.email,userId:v.id}),v.isAdmin?V(Y.ADMIN_LOGIN,{userId:v.id,timestamp:new Date().toISOString()}):V(Y.LOGIN_SUCCESS,{userId:v.id,timestamp:new Date().toISOString()}),localStorage.setItem("authToken","demo-token-"+v.id),localStorage.setItem("sessionExpiry",(Date.now()+Ce).toString()),localStorage.setItem("authUser",JSON.stringify(v)),s(!1),{success:!0,user:v}}catch(A){console.error("Login error:",A);const v="Login failed. Please check your credentials and try again.";return l(v),s(!1),V(Y.LOGIN_ERROR,{email:m,timestamp:new Date().toISOString(),error:v}),{success:!1,error:v}}},h=async(m,y,A)=>{console.log(`AuthProvider: Register attempt for ${m}`),l(null),s(!0);try{const v=tn(m,y);if(!v)return s(!1),{success:!1,error:"Registration failed. Please try again."};if(A){const q={name:A,metadata:{...v.metadata,displayName:A}};Hr(v.id,q)}const B=Mt(v);return console.log("AuthProvider: Registration successful, user:",B),t(B),f(Date.now()+Ce),ye("user_register",{email:B.email,userId:B.id}),V(Y.SIGNUP_SUCCESS,{userId:B.id,timestamp:new Date().toISOString()}),localStorage.setItem("authToken","demo-token-"+B.id),localStorage.setItem("sessionExpiry",(Date.now()+Ce).toString()),localStorage.setItem("authUser",JSON.stringify(B)),s(!1),{success:!0,user:B}}catch(v){console.error("Registration error:",v);const B="Registration failed. Please try again later.";return l(B),s(!1),V(Y.SIGNUP_ERROR,{email:m,timestamp:new Date().toISOString(),error:B}),{success:!1,error:B}}},w=async m=>{if(r){console.log("Updating user:",m);try{const y={...m,role:m.isAdmin?"admin":"user"},A=await Hr(r.id,y);if(A){const v=Mt(A);t(v)}}catch(y){console.error("Error updating user:",y)}}},O=async()=>{console.log("Refreshing user data");try{const m=st();t(m?Mt(m):null)}catch(m){console.error("Error refreshing user data:",m)}},D=async m=>{console.log("Password recovery requested for:",m);try{const y=Math.random().toString(36).substring(2,15);return console.log(`Recovery token for ${m}: ${y}`),rn({timestamp:Date.now(),action:"password_recovery_requested",level:"info",details:{email:m}}),{success:!0}}catch(y){return console.error("Error sending recovery email:",y),{success:!1,error:"Failed to send recovery email. Please try again later."}}},S=async m=>{s(!0),l(null),V(Y.PASSWORD_RESET_REQUEST,{email:m,timestamp:new Date().toISOString()});try{const y=await Rt({success:!0,message:"Password reset email sent. Please check your inbox."},1e3);return s(!1),y}catch(y){const A=y instanceof Error?y.message:"An unknown error occurred";return l(A),s(!1),{success:!1,message:A}}},I=async m=>{s(!0),l(null);try{const y=await Rt(!0,1e3);return s(!1),y}catch(y){const A=y instanceof Error?y.message:"An unknown error occurred";return l(A),s(!1),!1}},E=async(m,y)=>{s(!0),l(null),V(Y.PASSWORD_RESET_COMPLETE,{timestamp:new Date().toISOString()});try{const A=await Rt(!0,1e3);return s(!1),A}catch(A){const v=A instanceof Error?A.message:"An unknown error occurred";return l(v),s(!1),!1}},_=async(m,y)=>{console.log(`Initiating passwordless login for ${m} using ${y}`);try{return V(Y.PASSWORDLESS_INITIATED,{email:m,method:y,timestamp:new Date().toISOString()}),{success:!0,error:void 0}}catch(A){return console.error("Passwordless initiation error:",A),V(Y.PASSWORDLESS_ERROR,{email:m,method:y,error:A.message,timestamp:new Date().toISOString()}),{success:!1,error:"Failed to initiate passwordless login"}}},L=async(m,y,A)=>{if(y.length!==6||!/^\d+$/.test(y))return l("Invalid verification code format"),{success:!1,error:"Invalid verification code format"};s(!0),l(null);try{const v=await Rt({success:!0,user:{id:co(),email:m,name:"Demo User",isAdmin:!1,role:"user"}},1500);if(v.success&&v.user){const B=Date.now()+Ce;f(B),t(v.user),localStorage.setItem("authToken","demo-token-"+v.user.id),localStorage.setItem("sessionExpiry",B.toString()),localStorage.setItem("authUser",JSON.stringify(v.user)),V(Y.PASSWORDLESS_SUCCESS,{userId:v.user.id,method:A,timestamp:new Date().toISOString()})}return s(!1),v}catch(v){const B=v instanceof Error?v.message:"An unknown error occurred";return l(B),s(!1),V(Y.PASSWORDLESS_ERROR,{email:m,method:A,timestamp:new Date().toISOString(),error:B}),{success:!1,error:B}}},N=()=>[{id:"google",name:"Google Workspace",type:"oauth2",enabled:!0,metadata:{clientId:"mock-client-id"}},{id:"microsoft",name:"Microsoft Azure AD",type:"oidc",enabled:!0,metadata:{clientId:"mock-client-id"}},{id:"okta",name:"Okta SSO",type:"saml",enabled:!0,metadata:{entityId:"mock-entity-id"}},{id:"github",name:"GitHub",type:"oauth2",enabled:!0,metadata:{clientId:"mock-client-id"}}],b=async m=>{try{console.log(`Initiating SSO login for provider: ${m}`);const{addAuditLog:y}=await qe(()=>Promise.resolve().then(()=>cs),void 0);await y({timestamp:Date.now(),action:"sso_initiated",level:"info",details:{provider:m}}),V(Y.SSO_INITIATED,{provider:m,timestamp:new Date().toISOString()});const A=null;return setTimeout(()=>{const v={id:crypto.randomUUID(),email:`demo_${m.toLowerCase()}@example.com`,name:`Demo ${m} User`};R(m,v)},1500),{url:A,success:!0}}catch(y){return console.error("SSO initiation error:",y),V(Y.SSO_FAILURE,{provider:m,error:y.message,timestamp:new Date().toISOString()}),{url:null,error:"Failed to initiate SSO login",success:!1}}},R=async(m,y)=>{try{console.log(`Handling SSO callback for provider: ${m}`,y);const{createUser:A,updateUser:v,addAuditLog:B}=await qe(()=>Promise.resolve().then(()=>cs),void 0),q=y.id||crypto.randomUUID(),Le={id:q,email:y.email,name:y.name||`${m} User`,isAdmin:!1,role:"user",mfaEnabled:!1,createdAt:Date.now(),ssoProvider:m},ln=`sso-${crypto.randomUUID().slice(0,8)}`;let Ze=await A(y.email,ln);return Ze&&await v(Ze.id,{name:y.name||`${m} User`,metadata:{ssoProvider:m,lastSsoLogin:Date.now()}}),await B({timestamp:Date.now(),action:"sso_login",userId:q,level:"info",details:{provider:m,email:y.email}}),t(Le),localStorage.setItem("auth_session",JSON.stringify({id:Le.id,expiresAt:Date.now()+Ce,lastActivity:Date.now()})),V(Y.SSO_SUCCESS,{userId:Le.id,email:Le.email,provider:m,timestamp:new Date().toISOString()}),{success:!0,user:Le}}catch(A){return console.error("SSO callback error:",A),V(Y.SSO_ERROR,{provider:m,error:A.message,timestamp:new Date().toISOString()}),{success:!1,error:"Failed to authenticate with SSO provider"}}},C=()=>{if(!i)return 0;const m=Math.max(0,i-Date.now());return Math.floor(m/1e3)},j=()=>{console.log("Session extended"),f(Date.now()+Ce)};r?.isAdmin;const k={user:r,loading:n,error:a,isAuthenticated:!!r,isAdmin:!!r?.isAdmin,login:g,logout:x,register:h,updateUser:w,refreshUser:O,checkMfaRequired:ds,sendPasswordRecoveryEmail:D,resetPassword:S,verifyResetToken:I,confirmPasswordReset:E,getSessionTimeRemaining:C,extendSession:j,startPasswordlessLogin:_,verifyPasswordlessCode:L,getSSOProviders:N,initiateSSOLogin:b,handleSSOCallback:R};return o.jsx(sn.Provider,{value:k,children:e})},tr=()=>p.useContext(sn),Mt=e=>({id:e.id,email:e.email,name:e.name||e.email.split("@")[0],isAdmin:e.role==="admin",role:e.role,mfaEnabled:e.mfaEnabled,createdAt:e.createdAt,ssoProvider:e.metadata?.ssoProvider}),Cc=M.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 200px;
  will-change: transform; /* Hint to browser for optimization */
`,Ic=M.div`
  border: 4px solid rgba(0, 0, 0, 0.1);
  border-top: 4px solid var(--primary-color);
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 0.8s linear infinite;
  margin-bottom: 15px;
  will-change: transform; /* Hardware acceleration */
  transform: translateZ(0); /* Force GPU rendering */
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`,Rc=M.p`
  color: var(--dark-grey);
  font-size: 16px;
  font-weight: 500;
`,Oc=M.div`
  position: ${e=>e.$fullPage?"fixed":"static"};
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: ${e=>e.$fullPage?"rgba(255, 255, 255, 0.8)":"transparent"};
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  pointer-events: ${e=>e.$fullPage?"all":"none"};
`,$e=Wr.memo(({message:e="Loading...",fullPage:r=!1})=>o.jsx(Oc,{$fullPage:r,children:o.jsxs(Cc,{children:[o.jsx(Ic,{}),o.jsx(Rc,{children:e})]})}));$e.displayName="LoadingSpinner";const Uc=()=>o.jsx("span",{role:"img","aria-label":"User Icon",style:{marginRight:"8px",fontSize:"18px"},children:""}),Tc=()=>o.jsx("span",{role:"img","aria-label":"Log Icon",style:{marginRight:"8px",fontSize:"18px"},children:""}),Pc=()=>o.jsx("span",{role:"img","aria-label":"Settings Icon",style:{marginRight:"8px",fontSize:"18px"},children:""}),zc=Wr.memo(({users:e,height:r,width:t,onActionClick:n,openDropdownId:s,toggleDropdown:a})=>o.jsx("div",{style:{overflowX:"auto",width:"100%"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",tableLayout:"fixed"},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"#f8f9fa",borderBottom:"2px solid #e0e0e0"},children:[o.jsx("th",{style:{padding:"14px 10px",textAlign:"left",width:"30%",fontWeight:"600",color:"#202124"},children:"Email"}),o.jsx("th",{style:{padding:"14px 10px",textAlign:"left",width:"12%",fontWeight:"600",color:"#202124"},children:"Role"}),o.jsx("th",{style:{padding:"14px 10px",textAlign:"left",width:"12%",fontWeight:"600",color:"#202124"},children:"MFA STATUS"}),o.jsx("th",{style:{padding:"14px 10px",textAlign:"left",width:"20%",fontWeight:"600",color:"#202124"},children:"Created"}),o.jsx("th",{style:{padding:"14px 10px",textAlign:"left",width:"20%",fontWeight:"600",color:"#202124"},children:"Last Login"}),o.jsx("th",{style:{padding:"14px 10px",textAlign:"center",width:"6%",fontWeight:"600",color:"#202124"},children:"Actions"})]})}),o.jsx("tbody",{children:e.map(l=>o.jsxs("tr",{style:{borderBottom:"1px solid #e0e0e0",transition:"background-color 0.2s"},className:"user-row",children:[o.jsxs("td",{style:{padding:"14px 10px",wordBreak:"break-all",fontWeight:l.role==="admin"?"500":"normal"},children:[l.email,l.email==="keeseetyler@yahoo.com"&&o.jsx("span",{style:{marginLeft:"5px",color:"#1a73e8",fontSize:"12px",fontWeight:"bold"},children:"(PRIMARY ADMIN)"})]}),o.jsx("td",{style:{padding:"14px 10px"},children:o.jsx("span",{style:{display:"inline-block",padding:"3px 8px",borderRadius:"12px",backgroundColor:l.role==="admin"?"#e8f0fe":"#f1f3f4",color:l.role==="admin"?"#1a73e8":"#5f6368",fontSize:"12px",fontWeight:"500"},children:l.role.toUpperCase()})}),o.jsx("td",{style:{padding:"14px 10px"},children:o.jsx("span",{style:{display:"inline-block",padding:"3px 8px",borderRadius:"12px",backgroundColor:l.mfaEnabled?"#e6f4ea":"#fdeded",color:l.mfaEnabled?"#34a853":"#d93025",fontSize:"12px",fontWeight:"500"},children:l.mfaEnabled?"ENABLED":"DISABLED"})}),o.jsx("td",{style:{padding:"14px 10px",whiteSpace:"nowrap",color:"#5f6368"},children:new Date(l.createdAt).toLocaleString()}),o.jsx("td",{style:{padding:"14px 10px",whiteSpace:"nowrap",color:l.lastLogin?"#5f6368":"#d93025"},children:l.lastLogin?new Date(l.lastLogin).toLocaleString():"Never logged in"}),o.jsxs("td",{style:{padding:"14px 10px",textAlign:"center",position:"relative"},children:[o.jsx("button",{style:{border:"none",background:"none",cursor:"pointer",color:"#1a73e8",fontSize:"20px"},title:"User actions",onClick:i=>a(l.id,i),children:""}),s===l.id&&o.jsxs("div",{style:{position:"absolute",right:"10px",top:"45px",backgroundColor:"white",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",borderRadius:"8px",zIndex:100,width:"180px",border:"1px solid #e0e0e0"},children:[o.jsx("button",{style:{display:"block",width:"100%",textAlign:"left",padding:"10px 15px",borderBottom:"1px solid #f0f0f0",backgroundColor:"transparent",border:"none",cursor:"pointer",fontSize:"14px",color:"#202124"},onClick:()=>n(l.id,"edit"),children:"Edit User"}),o.jsx("button",{style:{display:"block",width:"100%",textAlign:"left",padding:"10px 15px",borderBottom:"1px solid #f0f0f0",backgroundColor:"transparent",border:"none",cursor:"pointer",fontSize:"14px",color:"#d93025"},onClick:()=>n(l.id,"delete"),children:"Delete User"}),o.jsx("button",{style:{display:"block",width:"100%",textAlign:"left",padding:"10px 15px",borderBottom:"1px solid #f0f0f0",backgroundColor:"transparent",border:"none",cursor:"pointer",fontSize:"14px",color:"#202124"},onClick:()=>n(l.id,"resetPassword"),children:"Reset Password"}),o.jsx("button",{style:{display:"block",width:"100%",textAlign:"left",padding:"10px 15px",backgroundColor:"transparent",border:"none",cursor:"pointer",fontSize:"14px",color:l.mfaEnabled?"#d93025":"#34a853"},onClick:()=>n(l.id,"toggleMfa"),children:l.mfaEnabled?"Disable MFA":"Enable MFA"})]})]})]},l.id))})]})})),fs=M.div`
  max-width: 1280px;
  margin: 0 auto;
  padding: 24px;
`,Mc=M.h2`
  color: #202124;
  margin-bottom: 24px;
  font-size: 28px;
  font-weight: 700;
  text-align: center;
`,$c=M.div`
  display: flex;
  margin-bottom: 24px;
  border-radius: 8px;
  background-color: #fff;
  box-shadow: none;
  border: 1px solid #eaeaea;
  overflow: hidden;
`,Lr=M.button`
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px 20px;
  background-color: ${e=>e.$active?"#f0f7ff":"transparent"};
  color: ${e=>e.$active?"#1a73e8":"#5f6368"};
  border: none;
  border-bottom: ${e=>e.$active?"3px solid #1a73e8":"3px solid transparent"};
  font-weight: ${e=>e.$active?"600":"500"};
  font-size: 16px;
  cursor: pointer;
  flex: 1;
  transition: all 0.2s ease;
  
  &:hover {
    background-color: ${e=>e.$active?"#f0f7ff":"#f5f5f5"};
  }
`,Nr=M.div`
  background-color: white;
  border-radius: 8px;
  padding: 24px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  border: 1px solid #eaeaea;
  margin-bottom: 24px;
`,Ie=M.button`
  background-color: #1a73e8;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 10px 16px;
  margin-right: 10px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.2s ease;
  
  &:hover {
    background-color: #0d66d0;
  }

  &:disabled {
    background-color: #b3b3b3;
    cursor: not-allowed;
  }
`,us=M(Ie)`
  background-color: #34a853;
  
  &:hover {
    background-color: #2d9249;
  }
  
  &:disabled {
    background-color: #b3b3b3;
  }
`,Fc=M.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #f0f0f0;
`,Hc=M.div`
  font-size: 14px;
  color: #555;
`,hs=M.input`
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 16px;
  width: 300px;
  font-size: 14px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  
  &:focus {
    outline: none;
    border-color: #1a73e8;
    box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
  }
`,Zc=M.div`
  display: flex;
  justify-content: space-between;
  margin-bottom: 24px;
  flex-wrap: wrap;
  gap: 16px;
`,$t=M.div`
  background-color: #ffffff;
  padding: 20px;
  border-radius: 6px;
  flex: 1;
  min-width: 180px;
  box-shadow: none;
  border: 1px solid #eaeaea;
  border-left: 4px solid #1a73e8;
  
  &:nth-child(2) {
    border-left-color: #ea4335;
  }
  
  &:nth-child(3) {
    border-left-color: #fbbc05;
  }
  
  &:nth-child(4) {
    border-left-color: #34a853;
  }
  
  @media (max-width: 768px) {
    min-width: 140px;
  }
`,Ft=M.div`
  font-size: 28px;
  font-weight: bold;
  color: #202124;
  margin-bottom: 8px;
`,Ht=M.div`
  font-size: 14px;
  color: #5f6368;
  font-weight: 500;
`,Bc=M.span`
  display: inline-block;
  padding: 4px 10px;
  border-radius: 16px;
  font-size: 12px;
  font-weight: 500;
  background-color: ${e=>{switch(e.level){case"error":return"#fdeded";case"warning":return"#fff8e6";default:return"#e8f5e9"}}};
  color: ${e=>{switch(e.level){case"error":return"#d32f2f";case"warning":return"#f57c00";default:return"#2e7d32"}}};
`,Zr=M.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 200px;
  width: 100%;
`,Wc=M.div`
  width: 100%;
  overflow-x: auto;
  padding-bottom: 10px;
  border-radius: 4px;
  border: 1px solid #f0f0f0;
`,Gc=Wr.memo(({logs:e,loading:r})=>r?o.jsx(Zr,{children:o.jsx($e,{message:"Loading audit logs..."})}):e.length?o.jsx("div",{className:"overflow-x-auto w-full",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:"Timestamp"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"Level"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"User ID"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(t=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:qc(t.timestamp)}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:o.jsx(Bc,{level:t.level,children:t.level.toUpperCase()})}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:t.userId||"System"}),o.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[t.action,t.details&&o.jsxs("details",{className:"mt-1",children:[o.jsx("summary",{className:"text-sm text-blue-600 cursor-pointer",children:"View Details"}),o.jsx("pre",{className:"mt-2 text-xs bg-gray-100 p-2 rounded overflow-auto max-h-40",children:JSON.stringify(t.details,null,2)})]})]})]},t.id))})]})}):o.jsx("p",{children:"No logs found matching your criteria."})),qc=e=>new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),an=()=>{tr();const[e,r]=p.useState("users"),[t,n]=p.useState([]),[s,a]=p.useState([]),[l,i]=p.useState([]),[f,c]=p.useState(""),[d,x]=p.useState(0),[g,h]=p.useState(0),[w,O]=p.useState(0),[D,S]=p.useState(0),[I,E]=p.useState(!0),[_,L]=p.useState(!1),[N,b]=p.useState(!1),[R,C]=p.useState(!1),[j,k]=p.useState(1160),[m,y]=p.useState(!0),A=p.useRef(null),[v,B]=p.useState("all"),[q,Le]=p.useState(25),[ln,Ze]=p.useState(null),[Ct,sr]=p.useState(null),[J,ar]=p.useState(Et),[ma,cn]=p.useState(!1),[dn,or]=p.useState(null),at=100,ie=p.useRef(!0),pa=(u,U)=>{switch(or(null),U){case"edit":alert(`Edit user with ID: ${u}`),ye("admin_edit_user_attempt",{userId:u});break;case"delete":window.confirm("Are you sure you want to delete this user?")&&(alert(`Delete user with ID: ${u}`),ye("admin_delete_user_attempt",{userId:u}));break;case"resetPassword":window.confirm("Are you sure you want to reset this user's password?")&&(alert(`Reset password for user with ID: ${u}`),ye("admin_reset_password_attempt",{userId:u}));break;case"toggleMfa":const Z=t.find($=>$.id===u);if(Z){const $=!Z.mfaEnabled;alert(`${$?"Enable":"Disable"} MFA for user with ID: ${u}`),ye(`admin_${$?"enable":"disable"}_mfa_attempt`,{userId:u})}break}},_a=(u,U)=>{U.stopPropagation(),or(dn===u?null:u)};p.useEffect(()=>{const u=()=>{or(null)};return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}},[]);const xa=p.useCallback(u=>{u.requireMfa&&console.log("MFA requirement enabled for all new users"),u.enforcePasswordPolicy&&console.log("Password complexity policy enforced"),u.enablePasswordless&&console.log("Passwordless login enabled"),u.logFailedLogins&&console.log("Failed login attempt logging enabled"),u.lockAccountAfterFailures&&console.log("Account locking after multiple failures enabled"),console.log(`Session timeout set to ${u.sessionTimeout} minutes`),u.enableDetailedLogs&&console.log("Detailed activity logging enabled"),u.retainLogsForDays>365&&console.log(`Log retention period set to ${u.retainLogsForDays} days`),u.enableAuditAlerts&&console.log("Audit alerts for suspicious activity enabled"),u.enableSsoIntegration&&console.log("SSO integration enabled"),console.log(`API rate limit set to ${u.apiRateLimit} requests/minute`),u.enableAnalytics&&console.log("Anonymous usage analytics enabled")},[]),ir=p.useMemo(()=>t.length?f?t.filter(u=>{const U=f.toLowerCase();return u.email.toLowerCase().includes(U)||u.name&&u.name.toLowerCase().includes(U)||u.role.toLowerCase().includes(U)}):t:[],[t,f]),fn=p.useMemo(()=>s.filter(u=>{const U=f?u.action.toLowerCase().includes(f.toLowerCase())||u.userId&&u.userId.toLowerCase().includes(f.toLowerCase()):!0,Z=v==="all"?!0:u.level===v;return U&&Z}),[s,f,v]),de=p.useMemo(()=>fn,[fn]),ba=p.useMemo(()=>{const u=d*q;return de.slice(u,u+q)},[de,d,q]),wa=p.useMemo(()=>t.filter(u=>u.role==="admin").length,[t]),ya=p.useMemo(()=>t.filter(u=>u.mfaEnabled).length,[t]);p.useEffect(()=>()=>{ie.current=!1},[]),p.useEffect(()=>{try{const u=nn();ar(u)}catch(u){console.error("Error loading system settings:",u)}},[]),p.useEffect(()=>{(async()=>{if(ie.current){y(!0);try{const U=Gt();n(U),i(U),S(U.length);const Z=dt();O(Z);const $=ct(q,d);a($)}catch(U){console.error("Error initializing dashboard:",U)}finally{ie.current&&(y(!1),E(!1))}}})()},[]),p.useEffect(()=>{e==="users"&&!m&&lr()},[g,e,m]),p.useEffect(()=>{e==="logs"&&!m&&cr()},[d,e,m]),p.useEffect(()=>{const u=()=>{A.current&&k(A.current.clientWidth)};u();const U=bn(u,200);return window.addEventListener("resize",U),()=>{window.removeEventListener("resize",U),U.cancel()}},[]);const lr=p.useCallback(async()=>{m||!ie.current||(E(!0),setTimeout(()=>{try{if(!ie.current)return;const u=Gt();ie.current&&(n(u),i(u),S(u.length),E(!1))}catch(u){console.error("Error loading users:",u),ie.current&&E(!1)}},10))},[m]),cr=p.useCallback(async()=>{m||!ie.current||(L(!0),setTimeout(()=>{try{if(!ie.current)return;const u=ct(q,d);ie.current&&(a(u),O(dt()),L(!1))}catch(u){console.error("Error loading logs:",u),ie.current&&L(!1)}},10))},[d,m,q]),un=p.useMemo(()=>bn((u,U)=>{const Z=u.toLowerCase();if(U==="users"){const $=t.filter(fe=>fe.email.toLowerCase().includes(Z)||fe.role.toLowerCase().includes(Z));i($)}else U==="logs"&&s.filter($=>$.user&&$.user.toLowerCase().includes(Z)||$.action.toLowerCase().includes(Z)||$.level.toLowerCase().includes(Z))},300),[t,s]),va=p.useCallback(u=>{const U=u.target.value;c(U),un(U,e)},[e,un]),Sa=p.useCallback(async()=>{try{L(!0);const u=ct(q,d);a(u),O(dt()),c(""),B("all")}catch(u){console.error("Error refreshing logs:",u)}finally{L(!1)}},[d,q]),Ea=p.useCallback(async()=>{if(!N){b(!0);try{const{exportUsersToPdf:u,exportAuditLogsToPdf:U}=await qe(()=>import("./exportPdf.951f235b.js").then($=>$.e),[]),{downloadPdf:Z}=await qe(()=>import("./exportPdf.951f235b.js").then($=>$.e),[]);if(e==="users"){if(console.log("Exporting users to PDF..."),!l||l.length===0){alert("No user data available to export");return}try{const $=await u(l),fe=`user-report-${new Date().toISOString().split("T")[0]}.pdf`;Z($,fe),alert("Users exported successfully!")}catch($){console.error("Error creating PDF:",$),alert(`Failed to export users: ${$ instanceof Error?$.message:"Unknown error"}`)}}else if(e==="logs"){console.log("Exporting logs to PDF...");const $=de;if(!$||$.length===0){alert("No log data available to export");return}try{const fe=await U($),Na=`audit-log-report-${new Date().toISOString().split("T")[0]}.pdf`;Z(fe,Na),alert("Logs exported successfully!")}catch(fe){console.error("Error creating PDF:",fe),alert(`Failed to export logs: ${fe instanceof Error?fe.message:"Unknown error"}`)}}}catch(u){console.error("Error loading export module:",u),alert("Failed to load export module")}finally{b(!1)}}},[e,l,de,N]),ka=p.useCallback(()=>{if(e==="users"){E(!0);try{const u=Gt();S(u.length);const U=u.slice(g*at,(g+1)*at);n(U),i(U),c("")}catch(u){console.error("Error refreshing users:",u)}finally{E(!1)}}else if(e==="logs"){L(!0);try{const u=ct(q,d);a(u),O(dt()),c("")}catch(u){console.error("Error refreshing logs:",u)}finally{L(!1)}}},[e,d,g,q,at]);p.useCallback(u=>{r(u),u==="users"&&t.length===0?lr():u==="logs"&&s.length===0&&cr()},[cr,lr,s.length,t.length]),p.useCallback(()=>{(d+1)*q<w&&x(d+1)},[d,q,w]),p.useCallback(()=>{d>0&&x(d-1)},[d]),p.useCallback(()=>{(g+1)*at<D&&h(g+1)},[g,D,at]),p.useCallback(()=>{g>0&&h(g-1)},[g]);const hn=u=>{u>=0&&u<Math.ceil(s.length/q)&&x(u)},Aa=async()=>{try{C(!0),Ze(null);const{exportAuditLogsToPdf:u,downloadPdf:U}=await qe(()=>import("./exportPdf.951f235b.js").then(Z=>Z.e),[]);try{const Z=await u(de),$=`audit-log-report-${new Date().toISOString().split("T")[0]}.pdf`;U(Z,$),sr({success:!0,count:de.length})}catch(Z){Ze(Z instanceof Error?Z.message:"Unknown error"),sr({success:!1,error:Z instanceof Error?Z.message:"Export failed"})}}catch(u){console.error("Error exporting logs:",u),Ze(u instanceof Error?u.message:"Unknown error"),sr({success:!1,error:u instanceof Error?u.message:"Unknown error during export"})}finally{C(!1)}};if(m)return o.jsx(fs,{children:o.jsx(Zr,{style:{height:"70vh"},children:o.jsx($e,{message:"Loading Admin Dashboard...",fullPage:!1})})});const ja=o.jsxs(Zc,{children:[o.jsxs($t,{children:[o.jsx(Ft,{children:D}),o.jsx(Ht,{children:"Registered Users"})]}),o.jsxs($t,{children:[o.jsx(Ft,{children:wa}),o.jsx(Ht,{children:"Administrators"})]}),o.jsxs($t,{children:[o.jsx(Ft,{children:ya}),o.jsx(Ht,{children:"MFA Enabled"})]}),o.jsxs($t,{children:[o.jsx(Ft,{children:w}),o.jsx(Ht,{children:"Audit Log Entries"})]})]}),Da=()=>{try{ga(J)?(xa(J),ye("admin_updated_settings",{settings:J}),cn(!0),setTimeout(()=>{ie.current&&cn(!1)},3e3)):console.error("Failed to save settings")}catch(u){console.error("Error saving settings:",u)}},gn=(u,U)=>{ar(Z=>({...Z,[u]:U}))},_e=u=>{gn(u,!J[u])},dr=(u,U)=>{gn(u,U)},La=()=>{ar(Et)};return o.jsxs(fs,{children:[o.jsx(Mc,{children:"Enterprise Authentication Admin Dashboard"}),ja,o.jsxs($c,{children:[o.jsxs(Lr,{$active:e==="users",onClick:()=>r("users"),children:[o.jsx(Uc,{})," Users"]}),o.jsxs(Lr,{$active:e==="logs",onClick:()=>r("logs"),children:[o.jsx(Tc,{})," Audit Logs"]}),o.jsxs(Lr,{$active:e==="settings",onClick:()=>r("settings"),children:[o.jsx(Pc,{})," Settings"]})]}),e==="users"&&o.jsxs(Nr,{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("h3",{style:{marginBottom:"12px",fontSize:"20px",fontWeight:"600"},children:"User Management"}),o.jsx("p",{style:{fontSize:"15px",color:"#5f6368",marginBottom:"16px",lineHeight:"1.5"},children:"View and manage all registered user accounts. All created accounts are displayed here for your review."})]}),o.jsxs("div",{children:[o.jsx(us,{onClick:Ea,disabled:N||I,style:{marginRight:"10px"},children:N?"Exporting...":"Export to PDF"}),o.jsx(Ie,{onClick:ka,disabled:I,children:I?"Loading...":"Refresh Users"})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"16px",alignItems:"center"},children:[o.jsx(hs,{type:"text",placeholder:"Search users by email or role...",value:f,onChange:va}),o.jsx("div",{style:{display:"flex",alignItems:"center"},children:o.jsxs("div",{style:{marginRight:"16px",display:"flex",alignItems:"center",padding:"8px 12px",backgroundColor:"#f1f3f4",borderRadius:"4px",fontSize:"14px"},children:[o.jsx("span",{role:"img","aria-label":"Filter",style:{marginRight:"6px"},children:""}),o.jsxs("span",{children:[o.jsx("strong",{children:ir.length})," ",ir.length===1?"user":"users"," found"]})]})})]}),I?o.jsx(Zr,{children:o.jsx($e,{message:"Loading users..."})}):o.jsx(Wc,{ref:A,children:o.jsx(zc,{users:ir,height:600,width:j,onActionClick:pa,openDropdownId:dn,toggleDropdown:_a})})]}),e==="logs"&&o.jsx(Nr,{children:o.jsxs("div",{className:"flex flex-col space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold mb-1",children:"Audit Log Management"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"View and export system activity and security events"})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(us,{onClick:Aa,disabled:R,children:R?"Exporting...":"Export PDF"}),o.jsx(Ie,{onClick:Sa,disabled:_,children:_?o.jsx("span",{children:"Refreshing..."}):o.jsx("span",{children:"Refresh"})})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4 sm:items-center",children:[o.jsx(hs,{type:"text",placeholder:"Filter by action or user ID",value:f,onChange:u=>c(u.target.value)}),o.jsxs("div",{className:"flex space-x-2 items-center",children:[o.jsxs("select",{className:"form-select rounded border border-gray-300 py-2 px-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:v,onChange:u=>B(u.target.value),children:[o.jsx("option",{value:"all",children:"All Levels"}),o.jsx("option",{value:"info",children:"Info Only"}),o.jsx("option",{value:"warning",children:"Warning Only"}),o.jsx("option",{value:"error",children:"Error Only"})]}),o.jsxs("select",{className:"form-select rounded border border-gray-300 py-2 px-3 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:q,onChange:u=>Le(Number(u.target.value)),children:[o.jsx("option",{value:"10",children:"10 per page"}),o.jsx("option",{value:"25",children:"25 per page"}),o.jsx("option",{value:"50",children:"50 per page"}),o.jsx("option",{value:"100",children:"100 per page"})]})]})]}),o.jsx("div",{className:"flex items-center text-sm text-gray-600",children:o.jsxs("span",{children:["Found ",de.length," ",de.length===1?"log":"logs"," matching your criteria"]})}),o.jsx("div",{className:"rounded-md border border-gray-200",children:o.jsx(Gc,{logs:ba,loading:_})}),o.jsxs(Fc,{children:[o.jsx(Ie,{onClick:()=>hn(d-1),disabled:d===0,children:"Previous"}),o.jsxs(Hc,{children:["Page ",d+1," of ",Math.max(1,Math.ceil(de.length/q))]}),o.jsx(Ie,{onClick:()=>hn(d+1),disabled:d>=Math.ceil(de.length/q)-1,children:"Next"})]}),Ct&&o.jsxs("div",{className:"mt-4 p-4 bg-gray-100 rounded-md",children:[o.jsx("h4",{className:"font-medium mb-2",children:"Export Result"}),o.jsx("div",{className:"text-sm",children:Ct.success?o.jsxs("div",{className:"text-green-600",children:["Successfully exported ",Ct.count," logs to PDF."]}):o.jsxs("div",{className:"text-red-600",children:["Error exporting logs: ",Ct.error]})})]})]})}),e==="settings"&&o.jsx(Nr,{children:o.jsxs("div",{className:"flex flex-col space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold mb-1",children:"System Settings"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Configure globalThis system settings and security policies"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"p-4 rounded-md border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-medium mb-3",children:"User Defaults"}),o.jsxs("div",{className:"flex flex-col space-y-4",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.requireMfa,onChange:()=>_e("requireMfa")}),"Require MFA for all new users"]})}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.enforcePasswordPolicy,onChange:()=>_e("enforcePasswordPolicy")}),"Enforce password complexity"]})}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.enablePasswordless,onChange:()=>_e("enablePasswordless")}),"Enable passwordless login"]})})]})]}),o.jsxs("div",{className:"p-4 rounded-md border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Settings"}),o.jsxs("div",{className:"flex flex-col space-y-4",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.logFailedLogins,onChange:()=>_e("logFailedLogins")}),"Log failed login attempts"]})}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.lockAccountAfterFailures,onChange:()=>_e("lockAccountAfterFailures")}),"Lock accounts after multiple failures"]})}),o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsx("label",{className:"font-medium text-sm",children:"Session timeout (minutes):"}),o.jsx("input",{type:"number",min:"5",max:"1440",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",value:J.sessionTimeout,onChange:u=>dr("sessionTimeout",parseInt(u.target.value))})]})]})]}),o.jsxs("div",{className:"p-4 rounded-md border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-medium mb-3",children:"Audit & Compliance"}),o.jsxs("div",{className:"flex flex-col space-y-4",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.enableDetailedLogs,onChange:()=>_e("enableDetailedLogs")}),"Enable detailed activity logging"]})}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.retainLogsForDays>365,onChange:()=>dr("retainLogsForDays",J.retainLogsForDays>365?90:366)}),"Retain logs for extended period (1 year+)"]})}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.enableAuditAlerts,onChange:()=>_e("enableAuditAlerts")}),"Enable audit alerts for suspicious activity"]})})]})]}),o.jsxs("div",{className:"p-4 rounded-md border border-gray-200",children:[o.jsx("h3",{className:"text-lg font-medium mb-3",children:"Integration Settings"}),o.jsxs("div",{className:"flex flex-col space-y-4",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.enableSsoIntegration,onChange:()=>_e("enableSsoIntegration")}),"Enable SSO integration"]})}),o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsx("label",{className:"font-medium text-sm",children:"API Rate Limit (requests/min):"}),o.jsx("input",{type:"number",min:"10",max:"1000",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",value:J.apiRateLimit,onChange:u=>dr("apiRateLimit",parseInt(u.target.value))})]}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("label",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",className:"mr-2 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",checked:J.enableAnalytics,onChange:()=>_e("enableAnalytics")}),"Enable anonymous usage analytics"]})})]})]})]}),o.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx(Ie,{onClick:La,className:"bg-gray-100 text-gray-800 hover:bg-gray-200",children:"Reset to Defaults"}),o.jsx(Ie,{onClick:Da,className:"bg-blue-600 text-white hover:bg-blue-700",children:"Save All Settings"})]}),ma&&o.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 text-green-700 rounded",children:"Settings saved successfully!"})]})})]})};an.preload=()=>qe(()=>Promise.resolve().then(()=>Kc),void 0);const Kc=Object.freeze(Object.defineProperty({__proto__:null,default:an},Symbol.toStringTag,{value:"Module"})),rr=()=>{const e=p.useContext(sn);return e?{...e,isAuthenticated:!!e.user,isAdmin:!!e.user?.isAdmin}:(console.error("useAuthContext: AuthContext not found"),{user:null,loading:!1,error:null,isAuthenticated:!1,isAdmin:!1,login:async()=>({success:!1,error:"Auth not initialized"}),logout:()=>console.error("Auth not initialized"),register:async()=>({success:!1,error:"Auth not initialized"}),updateUser:async()=>console.error("Auth not initialized"),refreshUser:async()=>console.error("Auth not initialized"),checkMfaRequired:async()=>!1,sendPasswordRecoveryEmail:async()=>({success:!1,error:"Auth not initialized"}),getSessionTimeRemaining:()=>0,extendSession:()=>console.error("Auth not initialized")})};var qt=(e=>(e.SAML="saml",e.OIDC="oidc",e.OAUTH2="oauth2",e))(qt||{});const nr=M.button`
  width: 100%;
  padding: 12px 16px;
  border-radius: 6px;
  border: 1px solid #e2e8f0;
  background: white;
  cursor: pointer;
  font-size: 14px;
  display: flex;
  align-items: center;
  transition: all 0.2s;
  text-align: left;
  margin-bottom: 8px;
  
  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
`;M(nr)`
  border-color: #4285f4;
  color: #4285f4;
  
  &:hover {
    background-color: rgba(66, 133, 244, 0.05);
  }
`;M(nr)`
  border-color: #00a4ef;
  color: #00a4ef;
  
  &:hover {
    background-color: rgba(0, 164, 239, 0.05);
  }
`;M(nr)`
  border-color: #007dc1;
  color: #007dc1;
  
  &:hover {
    background-color: rgba(0, 125, 193, 0.05);
  }
`;M(nr)`
  border-color: #333;
  color: #333;
  
  &:hover {
    background-color: rgba(51, 51, 51, 0.05);
  }
`;M.div`
  display: flex;
  align-items: center;
  margin: 20px 0;
  
  &::before, &::after {
    content: '';
    flex: 1;
    border-bottom: 1px solid #e2e8f0;
  }
`;M.span`
  padding: 0 10px;
  color: #718096;
  font-size: 14px;
`;M.div`
  display: flex;
  flex-direction: column;
  width: 100%;
  margin-top: 16px;
`;M.span`
  margin-right: 10px;
  font-size: 18px;
`;const Yc=e=>{const r=e.name.toLowerCase();if(r.includes("google"))return"";if(r.includes("github"))return"";if(r.includes("microsoft"))return"";if(r.includes("facebook"))return"";if(r.includes("apple"))return"";if(r.includes("twitter"))return"";if(r.includes("linkedin"))return"";switch(e.type){case qt.SAML:return"";case qt.OIDC:return"";case qt.OAUTH2:return"";default:return""}},Vc=e=>{const r=e.toLowerCase();return r.includes("google")?"#4285f4":r.includes("github")?"#333":r.includes("microsoft")?"#00a4ef":r.includes("facebook")?"#3b5998":r.includes("apple")?"#000000":r.includes("twitter")?"#1da1f2":r.includes("linkedin")?"#0077b5":r.includes("okta")?"#007dc1":"#718096"},Xc=({provider:e,onClick:r})=>{const t=Vc(e.name),n=Yc(e);return o.jsxs("button",{className:"sso-provider-button",onClick:r,style:{"--provider-color":t,borderColor:t,color:t},children:[o.jsx("span",{className:"provider-icon",children:n}),o.jsxs("span",{className:"provider-name",children:["Continue with ",e.name]})]})},Jc=()=>{const e=tr();Xt();const[r,t]=p.useState(!0),[n,s]=p.useState(!1),[a,l]=p.useState(null),[i,f]=p.useState([]),[c,d]=p.useState(null);p.useEffect(()=>{(async()=>{try{t(!0),l(null);const h=await e.getSSOProviders();f(h||[])}catch(h){console.error("Error loading SSO providers:",h),l("Failed to load login options. Please try again later.")}finally{t(!1)}})()},[e]);const x=async g=>{try{l(null),s(!0),d(g);const h=await e.initiateSSOLogin(g);h.success||(l(h.error||"SSO login failed. Please try again."),s(!1))}catch(h){console.error("SSO login error:",h),l("SSO login failed. Please try again or use another method."),s(!1)}};return r?o.jsx("div",{className:"sso-loading",children:"Loading login options..."}):n?o.jsx("div",{className:"sso-authenticating",children:o.jsx($e,{message:`Authenticating with ${c}...`})}):a?o.jsx("div",{className:"sso-error",children:a}):!i||i.length===0?null:o.jsxs("div",{className:"sso-providers-container",children:[o.jsx("div",{className:"sso-divider",children:o.jsx("span",{children:"Or continue with"})}),o.jsx("div",{className:"sso-buttons-container",children:i.map(g=>o.jsx(Xc,{provider:g,onClick:()=>x(g.id)},g.id))})]})},Cr=({initialMode:e="login"})=>{const[r,t]=p.useState(e),[n,s]=p.useState(""),[a,l]=p.useState(""),[i,f]=p.useState(""),[c,d]=p.useState(null),[x,g]=p.useState(!1),[h,w]=p.useState(!1),[O,D]=p.useState(!1),[S,I]=p.useState(!1),E=rr(),_=Xt();p.useEffect(()=>{E.isAuthenticated&&_("/dashboard");const k=m=>{m.altKey&&m.shiftKey&&m.key==="A"&&I(y=>!y)};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[E.isAuthenticated,_]);const L=()=>{t(r==="login"?"signup":"login"),d(null)},N=()=>!n||!a?(d("Please fill in all required fields"),!1):r==="signup"&&a!==i?(d("Passwords do not match"),!1):!0,b=async k=>{if(k.preventDefault(),d(null),!!N()){g(!0);try{if(r==="login"){console.log("Attempting login");const m=await E.login(n,a);console.log("Login result:",m),m.success?(console.log("Login successful, redirecting to dashboard"),_("/dashboard")):d(m.error||"Login failed")}else{console.log("Attempting registration");const m=await E.register(n,a);console.log("Registration result:",m),m.success?(console.log("Registration successful, redirecting to dashboard"),_("/dashboard")):d(m.error||"Registration failed")}}catch(m){console.error("Authentication error:",m),d(m.message||"An unexpected error occurred")}finally{g(!1)}}},R=()=>{s("admin@example.com"),l("password123")},C=()=>{w(!h),D(!1)},j=()=>{D(!O),w(!1)};return x?o.jsx("div",{className:"auth-loading-wrapper",children:o.jsx($e,{message:"Authenticating..."})}):o.jsxs("div",{className:"auth-page",children:[o.jsx("div",{className:"auth-gradient-bg"}),o.jsxs("div",{className:"floating-shapes",children:[o.jsx("div",{className:"shape shape-1"}),o.jsx("div",{className:"shape shape-2"}),o.jsx("div",{className:"shape shape-3"}),o.jsx("div",{className:"shape shape-4"})]}),o.jsxs("div",{className:"auth-container",children:[o.jsxs("div",{className:"auth-content",children:[o.jsxs("div",{className:"auth-header",children:[o.jsx("h1",{children:"Enterprise Authentication System"}),o.jsx("div",{className:"security-badge",children:o.jsx("span",{children:"HIPAA COMPLIANT"})})]}),o.jsx("div",{className:"auth-form-wrapper",children:!O&&!h?o.jsxs("div",{className:"auth-form-content",children:[o.jsx("h2",{className:"form-title",children:r==="login"?"Login":"Create Account"}),c&&o.jsxs("div",{className:"error-notification",children:[o.jsx("svg",{viewBox:"0 0 24 24",className:"error-icon",children:o.jsx("path",{d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{children:c})]}),o.jsxs("form",{onSubmit:b,className:"form",children:[o.jsxs("div",{className:"input-group",children:[o.jsx("input",{type:"email",id:"email",value:n,onChange:k=>s(k.target.value),className:"form-input",placeholder:"Email",required:!0}),o.jsx("label",{htmlFor:"email",className:"floating-label",children:"Email"})]}),o.jsxs("div",{className:"input-group",children:[o.jsx("input",{type:"password",id:"password",value:a,onChange:k=>l(k.target.value),className:"form-input",placeholder:"Password",required:!0}),o.jsx("label",{htmlFor:"password",className:"floating-label",children:"Password"})]}),r==="signup"&&o.jsxs("div",{className:"input-group",children:[o.jsx("input",{type:"password",id:"confirm-password",value:i,onChange:k=>f(k.target.value),className:"form-input",placeholder:"Confirm Password",required:!0}),o.jsx("label",{htmlFor:"confirm-password",className:"floating-label",children:"Confirm Password"})]}),o.jsx("button",{type:"submit",className:"submit-button",children:r==="login"?"Login":"Sign Up"})]}),o.jsxs("div",{className:"form-actions",children:[o.jsx("button",{className:"toggle-mode-button",onClick:L,children:r==="login"?"Need an account? Sign up":"Already have an account? Login"}),o.jsxs("div",{className:"alt-options",children:[o.jsx("span",{children:"Or continue with"}),o.jsxs("div",{className:"options-buttons",children:[o.jsxs("button",{className:"alt-auth-button",onClick:j,children:[o.jsx("svg",{viewBox:"0 0 24 24",className:"button-icon",children:o.jsx("path",{d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),o.jsx("span",{children:"Single Sign-On"})]}),o.jsxs("button",{className:"alt-auth-button",onClick:C,children:[o.jsx("svg",{viewBox:"0 0 24 24",className:"button-icon",children:o.jsx("path",{d:"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"})}),o.jsx("span",{children:"Passwordless"})]})]})]}),o.jsx(ft,{to:"/password-recovery",className:"recovery-link",children:"Forgot password?"}),S&&o.jsx("button",{className:"admin-login-button",onClick:R,children:"Use admin account"})]})]}):O?o.jsxs("div",{className:"alt-auth-content",children:[o.jsxs("div",{className:"alt-auth-header",children:[o.jsx("h2",{children:"Single Sign-On"}),o.jsx("button",{onClick:()=>D(!1),className:"close-button",children:o.jsx("svg",{viewBox:"0 0 24 24",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("p",{className:"alt-auth-desc",children:"Choose your organization's identity provider to sign in"}),o.jsx("div",{className:"sso-options-container",children:o.jsx(Jc,{})}),o.jsx("button",{onClick:()=>D(!1),className:"back-button",children:"Back to Login"})]}):o.jsxs("div",{className:"alt-auth-content",children:[o.jsxs("div",{className:"alt-auth-header",children:[o.jsx("h2",{children:"Passwordless Login"}),o.jsx("button",{onClick:()=>w(!1),className:"close-button",children:o.jsx("svg",{viewBox:"0 0 24 24",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsx("p",{className:"alt-auth-desc",children:"Enter your email to receive a magic link or code to login without a password."}),o.jsxs("div",{className:"alt-auth-form",children:[o.jsxs("div",{className:"input-group",children:[o.jsx("input",{type:"email",id:"passwordless-email",value:n,onChange:k=>s(k.target.value),className:"form-input",placeholder:"Email"}),o.jsx("label",{htmlFor:"passwordless-email",className:"floating-label",children:"Email"})]}),o.jsx("button",{className:"submit-button",onClick:()=>alert("Passwordless login feature coming soon!"),children:"Send Magic Link"}),o.jsx("button",{onClick:()=>w(!1),className:"back-button",children:"Back to Login"})]})]})})]}),o.jsx("div",{className:"auth-features",children:o.jsxs("div",{className:"feature-list",children:[o.jsxs("div",{className:"feature-item",children:[o.jsx("div",{className:"feature-icon",children:o.jsx("svg",{viewBox:"0 0 24 24",children:o.jsx("path",{d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),o.jsxs("div",{className:"feature-text",children:[o.jsx("h3",{children:"Multi-factor Authentication"}),o.jsx("p",{children:"Add an extra layer of security to your account"})]})]}),o.jsxs("div",{className:"feature-item",children:[o.jsx("div",{className:"feature-icon",children:o.jsx("svg",{viewBox:"0 0 24 24",children:o.jsx("path",{d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),o.jsxs("div",{className:"feature-text",children:[o.jsx("h3",{children:"Single Sign-On"}),o.jsx("p",{children:"Seamlessly connect with your existing accounts"})]})]}),o.jsxs("div",{className:"feature-item",children:[o.jsx("div",{className:"feature-icon",children:o.jsx("svg",{viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),o.jsxs("div",{className:"feature-text",children:[o.jsx("h3",{children:"Advanced Security"}),o.jsx("p",{children:"Enterprise-grade protection for your sensitive data"})]})]})]})})]}),o.jsxs("div",{className:"auth-footer",children:[o.jsxs("div",{className:"compliance-info",children:[o.jsx("span",{className:"badge",children:"HIPAA COMPLIANT"}),o.jsx("span",{className:"encryption-note",children:"End-to-end encryption"})]}),o.jsxs("div",{className:"copyright",children:["Enterprise Authentication System  ",new Date().getFullYear()]})]})]})},Qc=()=>{const{user:e,isAdmin:r}=rr(),t=Xt();return p.useEffect(()=>{r&&t("/admin")},[r,t]),o.jsx("div",{className:"container",children:o.jsxs("div",{className:"card",style:{maxWidth:"800px",margin:"2rem auto"},children:[o.jsx("h2",{className:"card-title",children:"Dashboard"}),e?o.jsxs("div",{children:[o.jsxs("p",{children:["Welcome, ",e.email,"!"]}),o.jsxs("p",{children:["You are logged in as: ",o.jsx("strong",{children:r?"Administrator":"User"})]}),o.jsxs("div",{style:{marginTop:"2rem"},children:[o.jsx("h3",{children:"Account Information"}),o.jsxs("p",{children:["Email: ",e.email]}),o.jsxs("p",{children:["Role: ",e.role||(r?"admin":"user")]}),o.jsxs("p",{children:["Account Created: ",e.createdAt?new Date(e.createdAt).toLocaleString():"Unknown"]}),o.jsxs("p",{children:["MFA Enabled: ",e.mfaEnabled?"Yes":"No"]})]})]}):o.jsx("p",{children:"Please log in to view your dashboard."})]})})};function ed(){return o.jsx("footer",{className:"footer",children:o.jsxs("div",{className:"container",children:[o.jsxs("div",{className:"encryption-indicator",children:["HIPAA Compliant ",o.jsx("span",{className:"hipaa-badge",children:"Encrypted"})," - All data is encrypted and stored securely in your browser."]}),o.jsx("p",{className:"footer-text",children:"This authentication system uses enterprise-level security practices including AES-256 encryption and secure password hashing."}),o.jsxs("p",{className:"footer-copyright",children:[" ",new Date().getFullYear()," Enterprise Account Authentication - HIPAA-Compliant Security System | Made by Tyler Keesee"]})]})})}const td=()=>{const[e,r]=p.useState(""),[t,n]=p.useState(!1),[s,a]=p.useState(null),[l,i]=p.useState(null),f=Xt(),c=tr(),d=async x=>{if(x.preventDefault(),!e){a("Please enter your email address");return}try{n(!0),a(null);const g=await c.sendPasswordRecoveryEmail(e);g.success?i(`Password reset instructions have been sent to ${e}. Please check your inbox.`):a(g.error||"Failed to send password reset email")}catch(g){console.error("Password reset error:",g),a("An unexpected error occurred")}finally{n(!1)}};return o.jsxs("div",{className:"reset-password-container",children:[o.jsx("h2",{children:"Reset Your Password"}),l?o.jsxs("div",{className:"reset-success",children:[o.jsx("div",{className:"reset-success-icon",children:""}),o.jsx("p",{children:l}),o.jsx("button",{className:"primary-button",onClick:()=>f("/login"),children:"Return to Login"})]}):o.jsxs(o.Fragment,{children:[o.jsx("p",{children:"Enter your email address and we'll send you instructions to reset your password."}),s&&o.jsx("div",{className:"error-message",children:s}),o.jsxs("form",{onSubmit:d,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"email",children:"Email Address"}),o.jsx("input",{type:"email",id:"email",value:e,onChange:x=>r(x.target.value),disabled:t,required:!0})]}),o.jsx("button",{type:"submit",className:"primary-button",disabled:t,children:t?"Sending...":"Send Reset Instructions"}),o.jsx("button",{type:"button",className:"text-button",onClick:()=>f("/login"),disabled:t,children:"Back to Login"})]})]})]})},rd=()=>{const{user:e,logout:r}=rr();return o.jsx("header",{className:"header",children:o.jsx("div",{className:"container",children:o.jsxs("div",{className:"flex-between",children:[o.jsx("h1",{children:o.jsx(ft,{to:"/",children:"Enterprise Authentication"})}),o.jsx("nav",{children:e?o.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[o.jsx(ft,{to:"/dashboard",className:"link",children:"Dashboard"}),o.jsx("button",{onClick:r,className:"link",children:"Logout"})]}):o.jsx(ft,{to:"/auth",className:"link",children:"Login"})})]})})})},nd=()=>o.jsx("div",{className:"container",style:{textAlign:"center",padding:"2rem 0"},children:o.jsxs("div",{className:"card",children:[o.jsx("h1",{style:{fontSize:"3rem",fontWeight:"bold",marginBottom:"1rem"},children:"404"}),o.jsx("h2",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"Page Not Found"}),o.jsx("p",{style:{marginBottom:"2rem"},children:"The page you are looking for doesn't exist or has been moved."}),o.jsx(ft,{to:"/",className:"btn btn-primary",children:"Go Home"})]})}),gs=({children:e,requireAdmin:r=!1})=>{const{user:t,isAdmin:n,loading:s}=rr(),[a,l]=p.useState(!0),i=Oa();return p.useEffect(()=>{const f=setTimeout(()=>{l(!1)},300);return()=>clearTimeout(f)},[]),a||s?o.jsxs("div",{className:"loading-container",style:{height:"70vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[o.jsx($e,{message:"Checking authentication..."}),o.jsx("p",{style:{marginTop:"15px",color:"#666"},children:"Verifying your credentials..."})]}):t?r&&!n?(console.warn("Admin access required but user is not an admin - redirecting to dashboard"),o.jsx(Re,{to:"/dashboard",replace:!0})):o.jsx(o.Fragment,{children:e}):(console.log("Protected route: No user found, redirecting to auth page"),o.jsx(Re,{to:"/auth",state:{from:i},replace:!0}))};console.log("App component loaded");console.log("Running in environment:","production");console.log("Base URL:",document.baseURI);const sd=()=>{const{user:e,isAdmin:r}=tr();return p.useEffect(()=>{console.log("App component mounted"),console.log("Auth state:",{isAuthenticated:!!e,isAdmin:r}),console.log("Current URL:",window.location.href),console.log("Pathname:",window.location.pathname),console.log("Hash:",window.location.hash)},[e,r]),o.jsx(Ua,{children:o.jsxs("div",{className:"app",children:[o.jsx(rd,{}),o.jsx("main",{className:"main-content",children:o.jsxs(Ta,{children:[o.jsx(ve,{path:"/",element:e?o.jsx(Re,{to:"/dashboard"}):o.jsx(Re,{to:"/auth"})}),o.jsx(ve,{path:"/auth",element:e?o.jsx(Re,{to:"/dashboard"}):o.jsx(Cr,{})}),o.jsx(ve,{path:"/login",element:e?o.jsx(Re,{to:"/dashboard"}):o.jsx(Cr,{initialMode:"login"})}),o.jsx(ve,{path:"/signup",element:e?o.jsx(Re,{to:"/dashboard"}):o.jsx(Cr,{initialMode:"signup"})}),o.jsx(ve,{path:"/forgot-password",element:o.jsx(td,{})}),o.jsx(ve,{path:"/dashboard",element:o.jsx(gs,{children:o.jsx(Qc,{})})}),o.jsx(ve,{path:"/admin",element:o.jsx(gs,{requireAdmin:!0,children:o.jsx(an,{})})}),o.jsx(ve,{path:"*",element:o.jsx(nd,{})})]})}),o.jsx(ed,{})]})})};function kt(e,r){try{return typeof globalThis<"u"&&(Object.defineProperty?Object.defineProperty(globalThis,e,{configurable:!0,writable:!0,value:r}):globalThis[e]=r),typeof window<"u"&&(Object.defineProperty?Object.defineProperty(window,e,{configurable:!0,writable:!0,value:r}):window[e]=r),!0}catch(t){return console.warn("Failed to define globalThis property:",e,t),!1}}typeof module<"u"&&(module.exports=kt);const _d=Object.freeze(Object.defineProperty({__proto__:null,default:kt},Symbol.toStringTag,{value:"Module"}));kt("globalThis",typeof window<"u"?window:typeof globalThis<"u"?globalThis:void 0);console.log("Enterprise Authentication System starting...");let on=!1;(function(){try{kt("process",{env:{NODE_ENV:"production"}}),typeof window<"u"&&!window.Buffer&&kt("Buffer",{}),console.log("Polyfills and globalThis properties initialized")}catch(r){console.error("Error setting up polyfills:",r)}})();window.addEventListener("error",e=>{if(console.error("Uncaught error:",e.error),e.error&&e.error.stack&&console.error("Error stack:",e.error.stack),!on){const r=document.getElementById("root");r&&(r.innerHTML=`
        <div style="padding: 20px; font-family: sans-serif;">
          <h2 style="color: #d32f2f;">Error Loading Application</h2>
          <p>The application encountered an error during initialization.</p>
          <p>Please check the console for more details or try refreshing the page.</p>
          <button onclick="window.location.reload()" style="padding: 8px 16px; background: #4285f4; color: white; border: none; border-radius: 4px; cursor: pointer;">
            Refresh Page
          </button>
        </div>
      `)}e.preventDefault()});const ad=()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];e&&(console.log(" Performance metrics:"),console.log(`- DOM Content Loaded: ${Math.round(e.domContentLoadedEventEnd-e.startTime)}ms`),console.log(`- First Paint: ${Math.round(performance.getEntriesByName("first-paint")[0]?.startTime||0)}ms`),console.log(`- Time to Interactive: ${Math.round(e.domInteractive-e.startTime)}ms`),console.log(`- Total Load Time: ${Math.round(e.loadEventEnd-e.startTime)}ms`))},0)},od=["https://fonts.googleapis.com","https://fonts.gstatic.com"];od.forEach(e=>{const r=document.createElement("link");r.rel="preconnect",r.href=e,r.crossOrigin="anonymous",document.head.appendChild(r)});function Br(){console.log("Removing loading screen");const e=document.getElementById("root-loading");e?(console.log("Found root-loading element, removing..."),e.style.opacity="0",e.style.transition="opacity 0.5s ease",setTimeout(()=>{e.parentNode&&(e.parentNode.removeChild(e),console.log("Root loading screen removed from DOM"))},500)):console.warn('No loading screen element found with ID "root-loading"')}function id(){try{const e=document.getElementById("root");if(!e){console.error("Root element not found in DOM!");return}console.log("Root element found, rendering application..."),ms(e).render(o.jsx(p.StrictMode,{children:o.jsx(Nc,{children:o.jsx(sd,{})})})),console.log("React render completed!"),on=!0,ad(),Br()}catch(e){console.error("Fatal error rendering application:",e),Br();const r=document.getElementById("root");r&&(r.innerHTML=`
        <div style="padding: 20px; font-family: sans-serif;">
          <h2 style="color: #d32f2f;">Application Error</h2>
          <p>Sorry, the application failed to initialize correctly.</p>
          <p>Please try refreshing the page or contact support if the issue persists.</p>
          <button onclick="window.location.reload()" style="padding: 8px 16px; background: #4285f4; color: white; border: none; border-radius: 4px; cursor: pointer;">
            Refresh Page
          </button>
        </div>
      `)}}console.log("Calling initApp()...");id();setTimeout(()=>{on||(console.warn("Application may not have rendered correctly, forcing removal of loading screen"),Br())},5e3);export{qe as _,_d as d};
//# sourceMappingURL=index.67c82f22.js.map
